<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Flipped</title>
  
  
  <link href="https://sknyt.xyz/atom.xml" rel="self"/>
  
  <link href="https://sknyt.xyz/"/>
  <updated>2021-02-17T04:08:32.344Z</updated>
  <id>https://sknyt.xyz/</id>
  
  <author>
    <name>ShikanoYuta</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MyPlanet</title>
    <link href="https://sknyt.xyz/iOS/MyPlanet/"/>
    <id>https://sknyt.xyz/iOS/MyPlanet/</id>
    <published>2021-02-17T04:00:45.000Z</published>
    <updated>2021-02-17T04:08:32.344Z</updated>
    
    <content type="html"><![CDATA[<p>记录一下第一个<del>较完整</del>的swift App</p><a id="more"></a><hr><p>Github：<a href="https://github.com/SaitoYayoi/My_Planet">https://github.com/SaitoYayoi/My_Planet</a></p><p><a href="/download/MyPlanet.zip">原文件</a>：</p><ul><li>MD5：24548214ff88c65757181803ada7936f</li><li>SHA-1：d704a0b51f44070cf7fa0a4ca6ebcc1f1e79a26f</li><li>SHA-256：16c90796c873f0884dfb006be82614ed56e1dd91db0962f2c0d0cf43a5113131</li></ul><hr><p>分类汇编：<a href="https://sknyt.xyz/iOS/Main/">首页</a>、<a href="https://sknyt.xyz/iOS/Mail">Mail页</a>、<a href="https://sknyt.xyz/iOS/Music">Music页</a>、<a href="https://sknyt.xyz/iOS/Weather">Weather页</a>、<a href="https://sknyt.xyz/iOS/Fate">Fate页</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;记录一下第一个&lt;del&gt;较完整&lt;/del&gt;的swift App&lt;/p&gt;</summary>
    
    
    
    <category term="iOS" scheme="https://sknyt.xyz/categories/iOS/"/>
    
    
    <category term="MyPlanet" scheme="https://sknyt.xyz/tags/MyPlanet/"/>
    
  </entry>
  
  <entry>
    <title>Markdown语法</title>
    <link href="https://sknyt.xyz/%E7%BD%91%E9%A1%B5/Markdown%E8%AF%AD%E6%B3%95/"/>
    <id>https://sknyt.xyz/%E7%BD%91%E9%A1%B5/Markdown%E8%AF%AD%E6%B3%95/</id>
    <published>2021-02-15T13:50:01.000Z</published>
    <updated>2021-02-16T02:32:25.224Z</updated>
    
    <content type="html"><![CDATA[<p>码了一点点的Markdown的语法</p><a id="more"></a><h1 id="一、标题"><a href="#一、标题" class="headerlink" title="一、标题"></a>一、标题</h1><p>在想要设置为标题的文字前面加#来表示<br>一个#是一级标题，二个#是二级标题，以此类推。支持六级标题。</p><p>注：标准语法一般在#后跟个空格再写文字，貌似简书不加空格也行。</p><p>示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 这是一级标题</span><br><span class="line">## 这是二级标题</span><br><span class="line">### 这是三级标题</span><br><span class="line">#### 这是四级标题</span><br><span class="line">##### 这是五级标题</span><br><span class="line">###### 这是六级标题</span><br></pre></td></tr></table></figure><p>效果如下：</p><h1 id="这是一级标题"><a href="#这是一级标题" class="headerlink" title="这是一级标题"></a>这是一级标题</h1><h2 id="这是二级标题"><a href="#这是二级标题" class="headerlink" title="这是二级标题"></a>这是二级标题</h2><h3 id="这是三级标题"><a href="#这是三级标题" class="headerlink" title="这是三级标题"></a>这是三级标题</h3><h4 id="这是四级标题"><a href="#这是四级标题" class="headerlink" title="这是四级标题"></a>这是四级标题</h4><h5 id="这是五级标题"><a href="#这是五级标题" class="headerlink" title="这是五级标题"></a>这是五级标题</h5><h6 id="这是六级标题"><a href="#这是六级标题" class="headerlink" title="这是六级标题"></a>这是六级标题</h6><hr><h1 id="二、字体"><a href="#二、字体" class="headerlink" title="二、字体"></a>二、字体</h1><ul><li><h5 id="加粗"><a href="#加粗" class="headerlink" title="加粗"></a>加粗</h5></li></ul><p>要加粗的文字左右分别用两个*号包起来</p><ul><li><h5 id="斜体"><a href="#斜体" class="headerlink" title="斜体"></a>斜体</h5></li></ul><p>要倾斜的文字左右分别用一个*号包起来</p><ul><li><h5 id="斜体加粗"><a href="#斜体加粗" class="headerlink" title="斜体加粗"></a>斜体加粗</h5></li></ul><p>要倾斜和加粗的文字左右分别用三个*号包起来</p><ul><li><h5 id="删除线"><a href="#删除线" class="headerlink" title="删除线"></a>删除线</h5></li></ul><p>要加删除线的文字左右分别用两个~~号包起来</p><p>示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">**这是加粗的文字**</span><br><span class="line">*这是倾斜的文字*&#96;</span><br><span class="line">***这是斜体加粗的文字***</span><br><span class="line">~~这是加删除线的文字~~</span><br></pre></td></tr></table></figure><p>效果如下：</p><p><strong>这是加粗的文字</strong><br><em>这是倾斜的文字</em><br><strong><em>这是斜体加粗的文字\</em></strong><br><del>这是加删除线的文字</del></p><hr><h1 id="三、引用"><a href="#三、引用" class="headerlink" title="三、引用"></a>三、引用</h1><p>在引用的文字前加&gt;即可。引用也可以嵌套，如加两个&gt;&gt;三个&gt;&gt;&gt; n个…<br>貌似可以一直加下去，但没神马卵用</p><p>示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;这是引用的内容</span><br><span class="line">&gt;&gt;这是引用的内容</span><br><span class="line">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;这是引用的内容</span><br></pre></td></tr></table></figure><p>效果如下：</p><blockquote><p>这是引用的内容</p><blockquote><p>这是引用的内容</p><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><p>这是引用的内容</p></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><h1 id="四、分割线"><a href="#四、分割线" class="headerlink" title="四、分割线"></a>四、分割线</h1><p>三个或者三个以上的 - 或者 * 都可以。</p><p>示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">----</span><br><span class="line">***</span><br><span class="line">*****</span><br></pre></td></tr></table></figure><p>效果如下：<br>可以看到，显示效果是一样的。</p><hr><hr><hr><hr><h1 id="五、图片"><a href="#五、图片" class="headerlink" title="五、图片"></a>五、图片</h1><p>语法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">![图片alt](图片地址 &#39;&#39;图片title&#39;&#39;)</span><br><span class="line"></span><br><span class="line">图片alt就是显示在图片下面的文字，相当于对图片内容的解释。</span><br><span class="line">图片title是图片的标题，当鼠标移到图片上时显示的内容。title可加可不加</span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">![blockchain](https:&#x2F;&#x2F;ss0.bdstatic.com&#x2F;70cFvHSh_Q1YnxGkpoWK1HF6hhy&#x2F;it&#x2F;</span><br><span class="line">u&#x3D;702257389,1274025419&amp;fm&#x3D;27&amp;gp&#x3D;0.jpg &quot;区块链&quot;)</span><br></pre></td></tr></table></figure><p>效果如下：</p><p><a href="https://upload-images.jianshu.io/upload_images/6860761-fd2f51090a890873.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/550/format/webp"><img src="https://upload-images.jianshu.io/upload_images/6860761-fd2f51090a890873.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/550/format/webp" alt="img"></a></p><p><a href="https://upload-images.jianshu.io/upload_images/6860761-fd2f51090a890873.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/550/format/webp">img</a></p><p>blockchain</p><p><strong>上传本地图片直接点击导航栏的图片标志，选择图片即可</strong></p><p>markdown格式追求的是简单、多平台统一。那么图片的存储就是一个问题，需要用图床，提供统一的外链，这样就不用在不同的平台去处理图片的问题了。才能做到书写一次，各处使用。<br>关于图床的选择我写了一篇文章，对网上存在的各种方法做了总结，需要的朋友可以看看。<a href="https://www.jianshu.com/p/ea1eb11db63f">markdown图床</a></p><h1 id="六、超链接"><a href="#六、超链接" class="headerlink" title="六、超链接"></a>六、超链接</h1><p>语法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[超链接名](超链接地址 &quot;超链接title&quot;)</span><br><span class="line">title可加可不加</span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[简书](http:&#x2F;&#x2F;jianshu.com)</span><br><span class="line">[百度](http:&#x2F;&#x2F;baidu.com)</span><br></pre></td></tr></table></figure><p>效果如下：</p><p><a href="https://www.jianshu.com/u/1f5ac0cf6a8b">简书</a><br><a href="https://links.jianshu.com/go?to=http://baidu.com">百度</a></p><p>注：Markdown本身语法不支持链接在新页面中打开，貌似简书做了处理，是可以的。别的平台可能就不行了，如果想要在新页面中打开的话可以用html语言的a标签代替。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;超链接地址&quot; target&#x3D;&quot;_blank&quot;&gt;超链接名&lt;&#x2F;a&gt;</span><br><span class="line"></span><br><span class="line">示例</span><br><span class="line">&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;www.jianshu.com&#x2F;u&#x2F;1f5ac0cf6a8b&quot; target&#x3D;&quot;_blank&quot;&gt;简书&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure><hr><h1 id="七、列表"><a href="#七、列表" class="headerlink" title="七、列表"></a>七、列表</h1><h5 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h5><p>语法：<br>无序列表用 - + * 任何一种都可以</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- 列表内容</span><br><span class="line">+ 列表内容</span><br><span class="line">* 列表内容</span><br><span class="line"></span><br><span class="line">注意：- + * 跟内容之间都要有一个空格</span><br></pre></td></tr></table></figure><p>效果如下：</p><ul><li>列表内容</li><li>列表内容</li><li>列表内容</li></ul><h5 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h5><p>语法：<br>数字加点</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 列表内容</span><br><span class="line">2. 列表内容</span><br><span class="line">3. 列表内容</span><br><span class="line"></span><br><span class="line">注意：序号跟内容之间要有空格</span><br></pre></td></tr></table></figure><p>效果如下：</p><ol><li>列表内容</li><li>列表内容</li><li>列表内容</li></ol><h5 id="列表嵌套"><a href="#列表嵌套" class="headerlink" title="列表嵌套"></a>列表嵌套</h5><p><strong>上一级和下一级之间敲三个空格即可</strong></p><ul><li>一级无序列表内容<ul><li>二级无序列表内容</li><li>二级无序列表内容</li><li>二级无序列表内容</li></ul></li><li>一级无序列表内容<ol><li>二级有序列表内容</li><li>二级有序列表内容</li><li>二级有序列表内容</li></ol></li></ul><ol><li>一级有序列表内容<ul><li>二级无序列表内容</li><li>二级无序列表内容</li><li>二级无序列表内容</li></ul></li><li>一级有序列表内容<ol><li>二级有序列表内容</li><li>二级有序列表内容</li><li>二级有序列表内容</li></ol></li></ol><hr><h1 id="八、表格"><a href="#八、表格" class="headerlink" title="八、表格"></a>八、表格</h1><p>语法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">表头|表头|表头</span><br><span class="line">---|:--:|---:</span><br><span class="line">内容|内容|内容</span><br><span class="line">内容|内容|内容</span><br><span class="line"></span><br><span class="line">第二行分割表头和内容。</span><br><span class="line">- 有一个就行，为了对齐，多加了几个</span><br><span class="line">文字默认居左</span><br><span class="line">-两边加：表示文字居中</span><br><span class="line">-右边加：表示文字居右</span><br><span class="line">注：原生的语法两边都要用 | 包起来。此处省略</span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">姓名|技能|排行</span><br><span class="line">--|:--:|--:</span><br><span class="line">刘备|哭|大哥</span><br><span class="line">关羽|打|二哥</span><br><span class="line">张飞|骂|三弟</span><br></pre></td></tr></table></figure><p>效果如下：</p><table><thead><tr><th align="left">姓名</th><th>技能</th><th>排行</th></tr></thead><tbody><tr><td align="left">刘备</td><td>哭</td><td>大哥</td></tr><tr><td align="left">关羽</td><td>打</td><td>二哥</td></tr><tr><td align="left">张飞</td><td>骂</td><td>三弟</td></tr></tbody></table><h1 id="九、代码"><a href="#九、代码" class="headerlink" title="九、代码"></a>九、代码</h1><p>语法：<br>单行代码：代码之间分别用一个反引号包起来</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#96;代码内容&#96;</span><br></pre></td></tr></table></figure><p>代码块：代码之间分别用三个反引号包起来，且两边的反引号单独占一行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(&#96;&#96;&#96;)</span><br><span class="line">  代码...</span><br><span class="line">  代码...</span><br><span class="line">  代码...</span><br><span class="line">(&#96;&#96;&#96;)</span><br></pre></td></tr></table></figure><blockquote><p>注：为了防止转译，前后三个反引号处加了小括号，实际是没有的。这里只是用来演示，实际中去掉两边小括号即可。</p></blockquote><p>示例：</p><p>单行代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#96;create database hero;&#96;</span><br></pre></td></tr></table></figure><p>代码块</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(&#96;&#96;&#96;)</span><br><span class="line">    function fun()&#123;</span><br><span class="line">         echo &quot;这是一句非常牛逼的代码&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    fun();</span><br><span class="line">(&#96;&#96;&#96;)</span><br></pre></td></tr></table></figure><p>效果如下：</p><p>单行代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database hero;</span><br></pre></td></tr></table></figure><p>代码块</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function fun()&#123;</span><br><span class="line">  echo &quot;这是一句非常牛逼的代码&quot;;</span><br><span class="line">&#125;</span><br><span class="line">fun();</span><br></pre></td></tr></table></figure><h1 id="十、本地下载"><a href="#十、本地下载" class="headerlink" title="十、本地下载"></a>十、本地下载</h1><p>语法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[下载内容](&#x2F;download&#x2F;文件名)</span><br></pre></td></tr></table></figure><hr><p>作者：高鸿祥<br>链接：<a href="https://www.jianshu.com/p/191d1e21f7ed">https://www.jianshu.com/p/191d1e21f7ed</a><br>来源：简书<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;码了一点点的Markdown的语法&lt;/p&gt;</summary>
    
    
    
    <category term="网页" scheme="https://sknyt.xyz/categories/%E7%BD%91%E9%A1%B5/"/>
    
    
    <category term="一点点码的东西" scheme="https://sknyt.xyz/tags/%E4%B8%80%E7%82%B9%E7%82%B9%E7%A0%81%E7%9A%84%E4%B8%9C%E8%A5%BF/"/>
    
  </entry>
  
  <entry>
    <title>頭に突然込んだまま造語</title>
    <link href="https://sknyt.xyz/%E6%97%A5%E6%9C%AC%E8%AA%9E/%E9%80%A0%E8%AF%AD/"/>
    <id>https://sknyt.xyz/%E6%97%A5%E6%9C%AC%E8%AA%9E/%E9%80%A0%E8%AF%AD/</id>
    <published>2021-02-10T13:51:53.000Z</published>
    <updated>2021-02-16T03:09:59.210Z</updated>
    
    <content type="html"><![CDATA[<p>  <strong>造語</strong>（ぞうご）は、新たに語（単語）を造ることや、既存の語を組み合わせて新たな意味の語を造ること、また、そうして造られた語である。新たに造られた語については、<strong>新語</strong>または<strong>新造語</strong>とも呼ばれる。</p><a id="more"></a><p>​    昔からいつもこの企画があるんけど、自分の言語を作ろうと思い、最近から真面目にやろうということを決めました。まっ始まるときから一大問題があって、それが読み方や書き方またはアルファベットを確定すること。自分が外で「フランス語を勉強しているよ、すごくわかっちゃったよねー」という、実は全然そんなことがないである。まだ、ゲルマン語系の発音や文字を選んだ、（興味あるから）。そして、IPA（って国際音標表）を調べて勉強し始めた。発音がヤッパリむずかしいね。特にたくさんの音標の発音が似てる。</p><p>て、「大舌音」と言うおとが出来ない、「小舌音」は一生懸命に勉強するあとで、成功したのに。<u><strong>サスガ俺！！！！！諦めぬ！</strong></u>それが一つだけ今回の冬休みの要望だろうね。じゃー、頑張ろ！！！</p><hr><p>2020/2/11に更新：諦めてしまいました</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;  &lt;strong&gt;造語&lt;/strong&gt;（ぞうご）は、新たに語（単語）を造ることや、既存の語を組み合わせて新たな意味の語を造ること、また、そうして造られた語である。新たに造られた語については、&lt;strong&gt;新語&lt;/strong&gt;または&lt;strong&gt;新造語&lt;/strong&gt;とも呼ばれる。&lt;/p&gt;</summary>
    
    
    
    <category term="日本語" scheme="https://sknyt.xyz/categories/%E6%97%A5%E6%9C%AC%E8%AA%9E/"/>
    
    
    <category term="随记" scheme="https://sknyt.xyz/tags/%E9%9A%8F%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>My Planet-MainViewController</title>
    <link href="https://sknyt.xyz/iOS/Main/"/>
    <id>https://sknyt.xyz/iOS/Main/</id>
    <published>2020-05-08T02:22:44.000Z</published>
    <updated>2021-02-17T03:59:21.181Z</updated>
    
    <content type="html"><![CDATA[<p>  首页主要实现功能：</p><ul><li>判断用户是否联网</li><li>完成通知中心Configuration</li><li>“New Message”字样闪烁</li><li>四个跳转UIButton</li><li>LocationManager初始化（为<a href="https://sknyt.xyz/iOS/Weather">Weather</a>做准备）</li><li>实现Tapic/Hapic震动反馈</li></ul><a id="more"></a><hr><h2 id="全局部分"><a href="#全局部分" class="headerlink" title="全局部分"></a>全局部分</h2><ol><li><p>引入：</p><ul><li>UIKit</li><li>SnapKit（约束）</li><li>CoreLocation（定位）</li><li>UserNotification（通知中心）</li><li>AudioToolBox.AudioServices（震动反馈）</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> SnapKit</span><br><span class="line"><span class="keyword">import</span> CoreLocation</span><br><span class="line"><span class="keyword">import</span> UserNotifications</span><br><span class="line"><span class="keyword">import</span> AudioToolbox.AudioServices</span><br></pre></td></tr></table></figure></li><li><p>全局变量、常量声明：</p><ul><li>Latitude（纬度）</li><li>Longitude（经度）</li><li>LongtitudePlusLatitude（经度+纬度）</li><li>Swidth（屏幕宽度）</li><li>Sheight（屏幕长度）</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> latitude <span class="operator">=</span> <span class="number">0.0</span></span><br><span class="line"><span class="keyword">var</span> longitude <span class="operator">=</span> <span class="number">0.0</span></span><br><span class="line"><span class="keyword">var</span> longtitudePlusLatitude:<span class="type">NSString</span>? <span class="operator">=</span> <span class="string">&quot;nil&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="type">Swidth</span> <span class="operator">=</span> <span class="type">UIScreen</span>.main.bounds.width</span><br><span class="line"><span class="keyword">let</span> <span class="type">Sheight</span> <span class="operator">=</span> <span class="type">UIScreen</span>.main.bounds.height</span><br></pre></td></tr></table></figure></li><li><p>闭包导入： 用于判断联网情况</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">requestUrl</span>(<span class="params">urlString</span>: <span class="type">String</span>)</span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> url: <span class="type">NSURL</span> <span class="operator">=</span> <span class="type">NSURL</span>(string: urlString)<span class="operator">!</span></span><br><span class="line">    <span class="keyword">let</span> request: <span class="type">NSMutableURLRequest</span> <span class="operator">=</span> <span class="type">NSMutableURLRequest</span>(url: url <span class="keyword">as</span> <span class="type">URL</span>)</span><br><span class="line">    request.timeoutInterval <span class="operator">=</span> <span class="number">5</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> response: <span class="type">URLResponse</span>?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> <span class="type">NSURLConnection</span>.sendSynchronousRequest(request <span class="keyword">as</span> <span class="type">URLRequest</span>, returning: <span class="operator">&amp;</span>response)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> httpResponse <span class="operator">=</span> response <span class="keyword">as?</span> <span class="type">HTTPURLResponse</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> httpResponse.statusCode <span class="operator">==</span> <span class="number">200</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (<span class="keyword">let</span> error) &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;error:<span class="subst">\(error)</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>判断软件版本（iOS10及以上）</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@available</span>(<span class="keyword">iOS</span> <span class="number">10.0</span>, <span class="operator">*</span>)</span><br></pre></td></tr></table></figure><h2 id="UIViewController类"><a href="#UIViewController类" class="headerlink" title="UIViewController类"></a>UIViewController类</h2></li><li><p>变量、常量声明：</p><ul><li>locationManager（用于定位）</li><li>timer</li><li>naviImage（图片）</li><li>UIButton</li><li>bgView（背景图片）</li><li>UITapGestureRecognizer</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> locationManager:<span class="type">CLLocationManager</span>!</span><br><span class="line">    <span class="keyword">var</span> timer:<span class="type">Timer</span>!</span><br><span class="line">    <span class="keyword">var</span> timer2:<span class="type">Timer</span>!</span><br><span class="line">    <span class="keyword">let</span> naviImage <span class="operator">=</span> <span class="type">UIImageView</span>()</span><br><span class="line">    <span class="keyword">let</span> nav1 <span class="operator">=</span> <span class="type">UIButton</span>(type: <span class="type">UIButton</span>.<span class="type">ButtonType</span>.custom)</span><br><span class="line">    <span class="keyword">let</span> nav2 <span class="operator">=</span> <span class="type">UIButton</span>(type: <span class="type">UIButton</span>.<span class="type">ButtonType</span>.custom)</span><br><span class="line">    <span class="keyword">let</span> nav3 <span class="operator">=</span> <span class="type">UIButton</span>(type: <span class="type">UIButton</span>.<span class="type">ButtonType</span>.custom)</span><br><span class="line">    <span class="keyword">let</span> nav4 <span class="operator">=</span> <span class="type">UIButton</span>(type: <span class="type">UIButton</span>.<span class="type">ButtonType</span>.custom)</span><br><span class="line">    <span class="keyword">let</span> bgView <span class="operator">=</span> <span class="type">UIImageView</span>()</span><br><span class="line">    <span class="keyword">let</span> bg <span class="operator">=</span> <span class="type">UIImage</span>(named: <span class="string">&quot;bg&quot;</span>)<span class="operator">?</span>.resizableImage(withCapInsets: <span class="type">UIEdgeInsets</span>(top: <span class="number">60</span>, left: <span class="number">15</span>, bottom: <span class="number">55</span>, right: <span class="number">15</span>), resizingMode: .stretch)</span><br><span class="line">    <span class="keyword">var</span> <span class="type">Tap</span> <span class="operator">=</span> <span class="type">UITapGestureRecognizer</span>()</span><br></pre></td></tr></table></figure></li><li><p>复写viewDidLoad闭包：</p><ul><li>生效通知</li><li>定位服务配置</li><li>遍历图片保证背景循环播放</li><li>timer配置</li><li>增加约束</li><li>增加UIbutton单击事件</li><li>设置UIButton属性</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"> notification()</span><br><span class="line"> everyDayNotification()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> locationManager <span class="operator">=</span> <span class="type">CLLocationManager</span>()</span><br><span class="line"> locationManager.delegate <span class="operator">=</span> <span class="keyword">self</span></span><br><span class="line"> locationManager.desiredAccuracy <span class="operator">=</span> kCLLocationAccuracyBest</span><br><span class="line"> locationManager.distanceFilter <span class="operator">=</span> <span class="number">10.0</span></span><br><span class="line"> locationManager.startUpdatingLocation()</span><br><span class="line"> <span class="keyword">if</span> (<span class="type">CLLocationManager</span>.authorizationStatus() <span class="operator">==</span> <span class="type">CLAuthorizationStatus</span>.notDetermined)&#123;</span><br><span class="line">     locationManager<span class="operator">?</span>.requestWhenInUseAuthorization()</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">var</span> background <span class="operator">=</span> [<span class="type">UIImage</span>]()</span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span> <span class="operator">...</span> <span class="number">4</span> &#123;</span><br><span class="line">     background.append(<span class="type">UIImage</span>(named: <span class="string">&quot;bg<span class="subst">\(i)</span>&quot;</span>)<span class="operator">!</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">let</span> imageView <span class="operator">=</span> <span class="type">UIImageView</span>()</span><br><span class="line"> imageView.animationImages <span class="operator">=</span> background</span><br><span class="line"> imageView.animationDuration <span class="operator">=</span> <span class="number">5</span></span><br><span class="line"> imageView.animationRepeatCount <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"> imageView.startAnimating()</span><br><span class="line"> <span class="keyword">self</span>.view.addSubview(imageView)</span><br><span class="line"> imageView.snp.makeConstraints &#123;(bg) <span class="keyword">in</span></span><br><span class="line">     bg.top.bottom.left.right.equalTo(<span class="number">0</span>)</span><br><span class="line">     bg.center.equalToSuperview()</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line">timer <span class="operator">=</span> <span class="type">Timer</span>.scheduledTimer(timeInterval: <span class="number">1</span>, target: <span class="keyword">self</span>, selector: #selector(<span class="keyword">self</span>.disappear), userInfo: <span class="literal">nil</span>, repeats: <span class="literal">true</span>)</span><br><span class="line"> timer2 <span class="operator">=</span> <span class="type">Timer</span>.scheduledTimer(timeInterval: <span class="number">2</span>, target: <span class="keyword">self</span>, selector: #selector(<span class="keyword">self</span>.appear), userInfo: <span class="literal">nil</span>, repeats: <span class="literal">true</span>)</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line"> </span><br><span class="line"> naviImage.image <span class="operator">=</span> <span class="type">UIImage</span>(named: <span class="string">&quot;navi&quot;</span>)</span><br><span class="line"> bgView.image <span class="operator">=</span> bg</span><br><span class="line"> <span class="keyword">self</span>.view.addSubview(bgView)</span><br><span class="line"> bgView.snp.makeConstraints &#123;(bg) <span class="keyword">in</span></span><br><span class="line">     bg.center.equalToSuperview()</span><br><span class="line">     bg.height.equalTo(<span class="number">100</span>)</span><br><span class="line">     bg.left.equalTo(<span class="number">0</span>).offset(<span class="number">35</span>)</span><br><span class="line">     bg.right.equalTo(<span class="number">0</span>).offset(<span class="operator">-</span><span class="number">35</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">self</span>.view.addSubview(naviImage)</span><br><span class="line"> naviImage.snp.makeConstraints &#123;(make) <span class="keyword">in</span></span><br><span class="line">     make.width.equalTo(<span class="number">210</span>)</span><br><span class="line">     make.height.equalTo(<span class="number">20</span>)</span><br><span class="line">     make.center.equalToSuperview()</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="type">Tap</span> <span class="operator">=</span> <span class="type">UITapGestureRecognizer</span>(target: <span class="keyword">self</span>, action: #selector(<span class="keyword">self</span>.animateAction(<span class="keyword">_</span>:)))</span><br><span class="line"> <span class="type">Tap</span>.numberOfTapsRequired <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"> <span class="type">Tap</span>.numberOfTouchesRequired <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"> <span class="keyword">self</span>.view.addGestureRecognizer(<span class="type">Tap</span>)</span><br><span class="line"> nav1.addTarget(<span class="keyword">self</span>, action: #selector(navi1), for: .touchUpInside)</span><br><span class="line"> nav2.addTarget(<span class="keyword">self</span>, action: #selector(navi2), for: .touchUpInside)</span><br><span class="line"> nav3.addTarget(<span class="keyword">self</span>, action: #selector(navi3), for: .touchUpInside)</span><br><span class="line"> nav3.addTarget(<span class="keyword">self</span>, action: #selector(navi3), for: .touchUpInside)</span><br><span class="line"> nav4.addTarget(<span class="keyword">self</span>, action: #selector(navi4), for: .touchUpInside)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> nav1.backgroundColor <span class="operator">=</span> <span class="type">UIColor</span>.clear</span><br><span class="line"> nav1.setTitle(<span class="string">&quot;看看信箱！&quot;</span>, for: <span class="type">UIControl</span>.<span class="type">State</span>())</span><br><span class="line"> nav1.setTitleColor(<span class="type">UIColor</span>.white, for: <span class="type">UIControl</span>.<span class="type">State</span>())</span><br><span class="line"> nav1.titleLabel<span class="operator">?</span>.font <span class="operator">=</span> <span class="type">UIFont</span>(name: <span class="string">&quot;Zpix&quot;</span>, size: <span class="number">30</span>)</span><br><span class="line"> </span><br><span class="line"> nav2.backgroundColor <span class="operator">=</span> <span class="type">UIColor</span>.clear</span><br><span class="line"> nav2.setTitle(<span class="string">&quot;看看天气。&quot;</span>, for: <span class="type">UIControl</span>.<span class="type">State</span>())</span><br><span class="line"> nav2.setTitleColor(<span class="type">UIColor</span>.white, for: <span class="type">UIControl</span>.<span class="type">State</span>())</span><br><span class="line"> nav2.titleLabel<span class="operator">?</span>.font <span class="operator">=</span> <span class="type">UIFont</span>(name: <span class="string">&quot;Zpix&quot;</span>, size: <span class="number">30</span>)</span><br><span class="line"> </span><br><span class="line"> nav3.backgroundColor <span class="operator">=</span> <span class="type">UIColor</span>.clear</span><br><span class="line"> nav3.setTitle(<span class="string">&quot;听一首歌。&quot;</span>, for: <span class="type">UIControl</span>.<span class="type">State</span>())</span><br><span class="line"> nav3.setTitleColor(<span class="type">UIColor</span>.white, for: <span class="type">UIControl</span>.<span class="type">State</span>())</span><br><span class="line"> nav3.titleLabel<span class="operator">?</span>.font <span class="operator">=</span> <span class="type">UIFont</span>(name: <span class="string">&quot;Zpix&quot;</span>, size: <span class="number">30</span>)</span><br><span class="line"> </span><br><span class="line"> nav4.backgroundColor <span class="operator">=</span> <span class="type">UIColor</span>.clear</span><br><span class="line"> nav4.setTitle(<span class="string">&quot;看看运势！&quot;</span>, for: <span class="type">UIControl</span>.<span class="type">State</span>())</span><br><span class="line"> nav4.setTitleColor(<span class="type">UIColor</span>.white, for: <span class="type">UIControl</span>.<span class="type">State</span>())</span><br><span class="line"> nav4.titleLabel<span class="operator">?</span>.font <span class="operator">=</span> <span class="type">UIFont</span>(name: <span class="string">&quot;Zpix&quot;</span>, size: <span class="number">30</span>)</span><br></pre></td></tr></table></figure></li><li><p>增加UIView动画，实现壁纸循环播放</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">disappear</span>()</span> &#123;</span><br><span class="line">    <span class="type">UIView</span>.animate(withDuration: <span class="number">0.5</span>, animations: &#123;</span><br><span class="line">        <span class="keyword">self</span>.naviImage.alpha <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">appear</span>()</span> &#123;</span><br><span class="line">    <span class="type">UIView</span>.animate(withDuration: <span class="number">0.5</span>, animations: &#123;</span><br><span class="line">        <span class="keyword">self</span>.naviImage.alpha <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>通知及每日通知配置</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">notification</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> content <span class="operator">=</span> <span class="type">UNMutableNotificationContent</span>()</span><br><span class="line">        content.sound <span class="operator">=</span> <span class="type">UNNotificationSound</span>.default</span><br><span class="line">        content.body <span class="operator">=</span> <span class="type">NSString</span>.localizedUserNotificationString(forKey: <span class="string">&quot;您回到了地球&quot;</span>, arguments: <span class="literal">nil</span>)</span><br><span class="line">               </span><br><span class="line">        <span class="keyword">let</span> infoDic <span class="operator">=</span> <span class="type">NSDictionary</span>(object: <span class="string">&quot;message.&quot;</span>, forKey: <span class="string">&quot;infoKey&quot;</span> <span class="keyword">as</span> <span class="type">NSCopying</span>)</span><br><span class="line">        content.userInfo <span class="operator">=</span> infoDic <span class="keyword">as</span> [<span class="type">NSObject</span> : <span class="type">AnyObject</span>]</span><br><span class="line">               </span><br><span class="line">        <span class="keyword">let</span> trigger <span class="operator">=</span> <span class="type">UNTimeIntervalNotificationTrigger</span>.<span class="keyword">init</span>(timeInterval: <span class="number">5.0</span>, repeats: <span class="literal">false</span>)</span><br><span class="line">        <span class="keyword">let</span> request <span class="operator">=</span> <span class="type">UNNotificationRequest</span>.<span class="keyword">init</span>(identifier: <span class="string">&quot;FiveSecond&quot;</span>, content: content, trigger: trigger)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> center <span class="operator">=</span> <span class="type">UNUserNotificationCenter</span>.current()</span><br><span class="line">        center.add(request)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">everyDayNotification</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> content <span class="operator">=</span> <span class="type">UNMutableNotificationContent</span>()</span><br><span class="line">        content.sound <span class="operator">=</span> <span class="type">UNNotificationSound</span>.default</span><br><span class="line">        content.body <span class="operator">=</span> <span class="type">NSString</span>.localizedUserNotificationString(forKey: <span class="string">&quot;来看看今天的天气和运势吧!&quot;</span>, arguments: <span class="literal">nil</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> compoents:<span class="type">DateComponents</span> <span class="operator">=</span> <span class="type">DateComponents</span>()</span><br><span class="line">        compoents.hour <span class="operator">=</span> <span class="number">9</span></span><br><span class="line">               </span><br><span class="line">        <span class="keyword">let</span> infoDic <span class="operator">=</span> <span class="type">NSDictionary</span>(object: <span class="string">&quot;message.&quot;</span>, forKey: <span class="string">&quot;infoKey&quot;</span> <span class="keyword">as</span> <span class="type">NSCopying</span>)</span><br><span class="line">        content.userInfo <span class="operator">=</span> infoDic <span class="keyword">as</span> [<span class="type">NSObject</span> : <span class="type">AnyObject</span>]</span><br><span class="line">               </span><br><span class="line">        <span class="keyword">let</span> trigger <span class="operator">=</span> <span class="type">UNCalendarNotificationTrigger</span>.<span class="keyword">init</span>(dateMatching: compoents, repeats: <span class="literal">true</span>)</span><br><span class="line">        <span class="keyword">let</span> request <span class="operator">=</span> <span class="type">UNNotificationRequest</span>.<span class="keyword">init</span>(identifier: <span class="string">&quot;FiveSecond&quot;</span>, content: content, trigger: trigger)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> center <span class="operator">=</span> <span class="type">UNUserNotificationCenter</span>.current()</span><br><span class="line">        center.add(request)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>定位服务配置</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">locationManager</span>(<span class="keyword">_</span> <span class="params">manager</span>: <span class="type">CLLocationManager</span>, <span class="params">didUpdateLocations</span> <span class="params">locations</span>: [<span class="type">CLLocation</span>])</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> location:<span class="type">CLLocation</span> <span class="operator">=</span> locations[<span class="number">0</span>]</span><br><span class="line">    latitude <span class="operator">=</span> location.coordinate.latitude</span><br><span class="line">    longitude <span class="operator">=</span> location.coordinate.longitude</span><br><span class="line">    longtitudePlusLatitude <span class="operator">=</span> (<span class="string">&quot;<span class="subst">\(NSString(string: String(longitude)))</span>,<span class="subst">\(NSString(string: String(latitude)))</span>&quot;</span>) <span class="keyword">as</span> <span class="type">NSString</span></span><br><span class="line">    <span class="type">UserDefaults</span>().setValue(longtitudePlusLatitude, forKey: <span class="string">&quot;info&quot;</span>)</span><br><span class="line">    locationManager.stopUpdatingLocation()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>UIButton单击事件：</p><ul><li>timer失效（背景停止刷新）</li><li>增加震动反馈（AudioServicesPlaySystemSound）</li><li>将四个子UIButton添加到视图</li><li>添加UIButton约束</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">timer.invalidate()</span><br><span class="line">timer2.invalidate()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> soundID <span class="operator">=</span> <span class="type">SystemSoundID</span>(<span class="number">1519</span>)</span><br><span class="line"><span class="type">AudioServicesPlaySystemSound</span>(soundID)</span><br><span class="line"></span><br><span class="line">naviImage.removeFromSuperview()</span><br><span class="line"><span class="type">Tap</span>.removeTarget(<span class="keyword">self</span>, action: #selector(<span class="keyword">self</span>.animateAction(<span class="keyword">_</span>:)))</span><br><span class="line"></span><br><span class="line">nav1.alpha <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">nav2.alpha <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">nav3.alpha <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">nav4.alpha <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">self</span>.view.addSubview(nav1)</span><br><span class="line"><span class="keyword">self</span>.view.addSubview(nav2)</span><br><span class="line"><span class="keyword">self</span>.view.addSubview(nav3)</span><br><span class="line"><span class="keyword">self</span>.view.addSubview(nav4)</span><br><span class="line"><span class="type">UIView</span>.animate(withDuration: <span class="number">0.6</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.bgView.alpha <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">self</span>.nav1.alpha <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">self</span>.nav2.alpha <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">self</span>.nav3.alpha <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">self</span>.nav4.alpha <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line">nav1.snp.makeConstraints &#123;(nav1) <span class="keyword">in</span></span><br><span class="line">    nav1.centerY.equalToSuperview().offset(<span class="operator">-</span><span class="number">80</span>)</span><br><span class="line">    nav1.centerX.equalToSuperview()</span><br><span class="line">&#125;</span><br><span class="line">nav2.snp.makeConstraints &#123;(nav2) <span class="keyword">in</span></span><br><span class="line">    nav2.centerY.equalToSuperview().offset(<span class="operator">-</span><span class="number">40</span>)</span><br><span class="line">    nav2.centerX.equalToSuperview()</span><br><span class="line">&#125;</span><br><span class="line">nav3.snp.makeConstraints &#123;(nav3) <span class="keyword">in</span></span><br><span class="line">    nav3.centerY.equalToSuperview()</span><br><span class="line">    nav3.centerX.equalToSuperview()</span><br><span class="line">&#125;</span><br><span class="line">nav4.snp.makeConstraints &#123;(nav4) <span class="keyword">in</span></span><br><span class="line">    nav4.centerY.equalToSuperview().offset(<span class="number">40</span>)</span><br><span class="line">    nav4.centerX.equalToSuperview()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>增加子UIButton单击事件：</p><ul><li>震动反馈</li><li>跳转子页面</li><li>部分页面验证是否联网，网络不通则跳转至Error-Controller</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">navi1</span>(<span class="keyword">_</span> <span class="params">sender</span>: <span class="type">UIButton</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> soundID <span class="operator">=</span> <span class="type">SystemSoundID</span>(<span class="number">1519</span>)</span><br><span class="line">        <span class="type">AudioServicesPlaySystemSound</span>(soundID)</span><br><span class="line">        <span class="keyword">let</span> mail <span class="operator">=</span> <span class="type">MailViewController</span>()</span><br><span class="line">        <span class="keyword">self</span>.present(mail, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="keyword">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">navi2</span>(<span class="keyword">_</span> <span class="params">sender</span>: <span class="type">UIButton</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> soundID <span class="operator">=</span> <span class="type">SystemSoundID</span>(<span class="number">1519</span>)</span><br><span class="line">        <span class="type">AudioServicesPlaySystemSound</span>(soundID)</span><br><span class="line">        <span class="keyword">let</span> networkStatus <span class="operator">=</span> requestUrl(urlString: <span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> networkStatus <span class="operator">==</span> <span class="literal">false</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> fal <span class="operator">=</span> <span class="type">NetworkErrorWeatherViewController</span>()</span><br><span class="line">            <span class="keyword">self</span>.present(fal, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> weather <span class="operator">=</span> <span class="type">WeatherViewController</span>()</span><br><span class="line">            <span class="keyword">self</span>.present(weather, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="keyword">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">navi3</span>(<span class="keyword">_</span> <span class="params">sender</span>: <span class="type">UIButton</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> soundID <span class="operator">=</span> <span class="type">SystemSoundID</span>(<span class="number">1519</span>)</span><br><span class="line">        <span class="type">AudioServicesPlaySystemSound</span>(soundID)</span><br><span class="line">        <span class="keyword">let</span> music <span class="operator">=</span> <span class="type">MusicViewController</span>()</span><br><span class="line">        <span class="keyword">self</span>.present(music, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="keyword">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">navi4</span>(<span class="keyword">_</span> <span class="params">sender</span>: <span class="type">UIButton</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> soundID <span class="operator">=</span> <span class="type">SystemSoundID</span>(<span class="number">1519</span>)</span><br><span class="line">        <span class="type">AudioServicesPlaySystemSound</span>(soundID)</span><br><span class="line">        <span class="keyword">let</span> networkStatus <span class="operator">=</span> requestUrl(urlString: <span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> networkStatus <span class="operator">==</span> <span class="literal">false</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> fal <span class="operator">=</span> <span class="type">NetworkErrorFateViewController</span>()</span><br><span class="line">            <span class="keyword">self</span>.present(fal, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> fate <span class="operator">=</span> <span class="type">FateViewController</span>()</span><br><span class="line">        <span class="keyword">self</span>.present(fate, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><a href="/download/MainViewController.swift">原文件</a></p></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;  首页主要实现功能：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;判断用户是否联网&lt;/li&gt;
&lt;li&gt;完成通知中心Configuration&lt;/li&gt;
&lt;li&gt;“New Message”字样闪烁&lt;/li&gt;
&lt;li&gt;四个跳转UIButton&lt;/li&gt;
&lt;li&gt;LocationManager初始化（为&lt;a href=&quot;https://sknyt.xyz/iOS/Weather&quot;&gt;Weather&lt;/a&gt;做准备）&lt;/li&gt;
&lt;li&gt;实现Tapic/Hapic震动反馈&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="iOS" scheme="https://sknyt.xyz/categories/iOS/"/>
    
    
    <category term="MyPlanet" scheme="https://sknyt.xyz/tags/MyPlanet/"/>
    
  </entry>
  
  <entry>
    <title>My Planet-FateViewController</title>
    <link href="https://sknyt.xyz/iOS/Fate/"/>
    <id>https://sknyt.xyz/iOS/Fate/</id>
    <published>2020-04-15T03:48:46.000Z</published>
    <updated>2021-02-17T03:59:08.318Z</updated>
    
    <content type="html"><![CDATA[<p>Fate页主要实现功能：</p><ul><li>用户输入星座</li><li>返回当日运势</li><li>打字机输出</li><li>返回首页</li></ul><a id="more"></a><hr><p>API源：<a href="https://www.juhe.cn/docs/api/id/58">聚合API</a></p><hr><h2 id="全局部分"><a href="#全局部分" class="headerlink" title="全局部分"></a>全局部分</h2><ol><li><p>引入:</p><ul><li>UIKit</li><li>SwiftyJSON</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> SwiftyJSON</span><br></pre></td></tr></table></figure></li><li><p>全局变量、常量声明：</p><ul><li>timer</li><li>UILabel</li><li>UITextField（监测用户输入）</li><li>初始字符串str</li><li>遍历次数</li><li>JSON字典</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> timer:<span class="type">Timer</span>!</span><br><span class="line"><span class="keyword">var</span> timer2:<span class="type">Timer</span>!</span><br><span class="line"><span class="keyword">let</span> preTextLabel <span class="operator">=</span> <span class="type">UILabel</span>()</span><br><span class="line"><span class="keyword">let</span> <span class="type">TextField</span> <span class="operator">=</span> <span class="type">UITextField</span>()</span><br><span class="line"><span class="keyword">let</span> consLabel <span class="operator">=</span> <span class="type">UILabel</span>()</span><br><span class="line"><span class="keyword">let</span> str <span class="operator">=</span> <span class="string">&quot;你的星座是:&quot;</span></span><br><span class="line"><span class="keyword">var</span> i <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">var</span> times <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">var</span> cons <span class="operator">=</span> <span class="string">&quot;nil&quot;</span></span><br><span class="line"><span class="keyword">var</span> info:<span class="type">Dictionary</span>&lt;<span class="type">String</span>,<span class="type">JSON</span>&gt; <span class="operator">=</span> [<span class="string">&quot;name&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>), <span class="string">&quot;datetime&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>), <span class="string">&quot;all&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>), <span class="string">&quot;color&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>), <span class="string">&quot;health&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>), <span class="string">&quot;love&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>), <span class="string">&quot;money&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>), <span class="string">&quot;number&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>), <span class="string">&quot;QFriend&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>), <span class="string">&quot;summary&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>), <span class="string">&quot;work&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>)]</span><br></pre></td></tr></table></figure><h2 id="UIViewController类"><a href="#UIViewController类" class="headerlink" title="UIViewController类"></a>UIViewController类</h2></li><li><p>返回首页</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure></li><li><p>timer配置（打字机）</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">    preTextLabel.backgroundColor <span class="operator">=</span> <span class="type">UIColor</span>.clear</span><br><span class="line">    <span class="keyword">self</span>.view.addSubview(preTextLabel)</span><br><span class="line">    preTextLabel.textColor <span class="operator">=</span> <span class="type">UIColor</span>.white</span><br><span class="line">    preTextLabel.font <span class="operator">=</span> <span class="type">UIFont</span>(name: <span class="string">&quot;Zpix&quot;</span>, size: <span class="number">20</span>)</span><br><span class="line">    preTextLabel.lineBreakMode <span class="operator">=</span> <span class="type">NSLineBreakMode</span>.byWordWrapping</span><br><span class="line">    preTextLabel.numberOfLines <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    preTextLabel.snp.makeConstraints &#123;(preTextLabel) <span class="keyword">in</span></span><br><span class="line">        preTextLabel.width.equalTo(<span class="number">300</span>)</span><br><span class="line">        preTextLabel.centerX.equalToSuperview().offset(<span class="operator">-</span><span class="number">25</span>)</span><br><span class="line">        preTextLabel.centerY.equalToSuperview().offset(<span class="operator">-</span><span class="number">50</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> i <span class="operator">&lt;=</span> <span class="number">8</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> output <span class="operator">=</span> str.prefix(i)</span><br><span class="line">    preTextLabel.text <span class="operator">=</span> <span class="type">String</span>(output)</span><br><span class="line">    i<span class="operator">+=</span><span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    timer.invalidate()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> i <span class="operator">==</span> <span class="number">8</span>&#123;</span><br><span class="line">    <span class="keyword">self</span>.view.addSubview(<span class="type">TextField</span>)</span><br><span class="line">    <span class="type">TextField</span>.snp.makeConstraints &#123;(textField) <span class="keyword">in</span></span><br><span class="line">        textField.width.equalTo(<span class="number">100</span>)</span><br><span class="line">        textField.centerY.equalTo(preTextLabel)</span><br><span class="line">        textField.centerX.equalTo(preTextLabel).offset(<span class="number">25</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br></pre></td></tr></table></figure></li><li><p>TextField代理、URL会话配置及访问、防呆、分析返回数据</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">TextField</span>.resignFirstResponder()</span><br><span class="line">cons <span class="operator">=</span> <span class="type">TextField</span>.text<span class="operator">!</span></span><br><span class="line"><span class="keyword">if</span> cons <span class="operator">==</span> <span class="string">&quot;水瓶&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;双鱼&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;白羊&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;金牛&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;双子&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;巨蟹&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;狮子&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;处女&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;天秤&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;天蝎&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;射手&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;摩羯&quot;</span> &#123;</span><br><span class="line">    cons <span class="operator">=</span> cons <span class="operator">+</span> <span class="string">&quot;座&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> urlString <span class="operator">=</span> <span class="string">&quot;http://web.juhe.cn:8080/constellation/getAll?key=b9e394f24f7890c24b19db0ef6b44c00&amp;type=today&amp;consName=<span class="subst">\(cons)</span>&quot;</span></span><br><span class="line"><span class="keyword">let</span> urlStr <span class="operator">=</span> urlString.addingPercentEncoding(withAllowedCharacters: .urlQueryAllowed)</span><br><span class="line"><span class="keyword">let</span> config <span class="operator">=</span> <span class="type">URLSessionConfiguration</span>.default</span><br><span class="line"><span class="keyword">let</span> url <span class="operator">=</span> <span class="type">URL</span>(string: urlStr<span class="operator">!</span>)</span><br><span class="line"><span class="keyword">let</span> session <span class="operator">=</span> <span class="type">URLSession</span>(configuration: config)</span><br><span class="line"><span class="keyword">let</span> task <span class="operator">=</span> session.dataTask(with: url<span class="operator">!</span>) &#123;(data, response, error) <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">let</span> json <span class="operator">=</span> <span class="keyword">try!</span> <span class="type">JSON</span>(data: data<span class="operator">!</span>)</span><br><span class="line">    info[<span class="string">&quot;name&quot;</span>] <span class="operator">=</span> json[<span class="string">&quot;name&quot;</span>]</span><br><span class="line">    info[<span class="string">&quot;datetime&quot;</span>] <span class="operator">=</span> json[<span class="string">&quot;datetime&quot;</span>]</span><br><span class="line">    info[<span class="string">&quot;all&quot;</span>] <span class="operator">=</span> json[<span class="string">&quot;all&quot;</span>]</span><br><span class="line">    info[<span class="string">&quot;color&quot;</span>] <span class="operator">=</span> json[<span class="string">&quot;color&quot;</span>]</span><br><span class="line">    info[<span class="string">&quot;health&quot;</span>] <span class="operator">=</span> json[<span class="string">&quot;health&quot;</span>]</span><br><span class="line">    info[<span class="string">&quot;love&quot;</span>] <span class="operator">=</span> json[<span class="string">&quot;love&quot;</span>]</span><br><span class="line">    info[<span class="string">&quot;money&quot;</span>] <span class="operator">=</span> json[<span class="string">&quot;money&quot;</span>]</span><br><span class="line">    info[<span class="string">&quot;number&quot;</span>] <span class="operator">=</span> json[<span class="string">&quot;number&quot;</span>]</span><br><span class="line">    info[<span class="string">&quot;QFriend&quot;</span>] <span class="operator">=</span> json[<span class="string">&quot;QFriend&quot;</span>]</span><br><span class="line">    info[<span class="string">&quot;summary&quot;</span>] <span class="operator">=</span> json[<span class="string">&quot;summary&quot;</span>]</span><br><span class="line">    info[<span class="string">&quot;work&quot;</span>] <span class="operator">=</span> json[<span class="string">&quot;work&quot;</span>]</span><br><span class="line">    i <span class="operator">=</span> <span class="number">100</span></span><br><span class="line">&#125;</span><br><span class="line">task.resume()</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></li><li><p>复写viewDidLoad：</p><ul><li>timer配置</li><li>textField配合</li><li>背景图片遍历</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">timer <span class="operator">=</span> <span class="type">Timer</span>.scheduledTimer(timeInterval: <span class="number">0.35</span>, target: <span class="keyword">self</span>, selector: #selector(<span class="type">FateViewController</span>.preTextPrint(<span class="keyword">_</span>:)), userInfo: <span class="literal">nil</span>, repeats: <span class="literal">true</span>)</span><br><span class="line">timer2 <span class="operator">=</span> <span class="type">Timer</span>.scheduledTimer(timeInterval: <span class="number">0.1</span>, target: <span class="keyword">self</span>, selector: #selector(<span class="type">FateViewController</span>.consPrint(<span class="keyword">_</span>:)), userInfo: <span class="literal">nil</span>, repeats: <span class="literal">true</span>)</span><br><span class="line"><span class="type">TextField</span>.borderStyle <span class="operator">=</span> <span class="type">UITextField</span>.<span class="type">BorderStyle</span>.roundedRect</span><br><span class="line"><span class="type">TextField</span>.textAlignment <span class="operator">=</span> <span class="type">NSTextAlignment</span>.center</span><br><span class="line"><span class="type">TextField</span>.backgroundColor <span class="operator">=</span> <span class="type">UIColor</span>.clear</span><br><span class="line"><span class="type">TextField</span>.returnKeyType <span class="operator">=</span> <span class="type">UIReturnKeyType</span>.done</span><br><span class="line"><span class="type">TextField</span>.delegate <span class="operator">=</span> <span class="keyword">self</span></span><br><span class="line"><span class="type">TextField</span>.textColor <span class="operator">=</span> <span class="type">UIColor</span>.white</span><br><span class="line"><span class="type">TextField</span>.font <span class="operator">=</span> <span class="type">UIFont</span>(name: <span class="string">&quot;Zpix&quot;</span>, size: <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> background <span class="operator">=</span> [<span class="type">UIImage</span>]()</span><br><span class="line">       <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span> <span class="operator">...</span> <span class="number">4</span> &#123;</span><br><span class="line">           background.append(<span class="type">UIImage</span>(named: <span class="string">&quot;bg<span class="subst">\(i)</span>&quot;</span>)<span class="operator">!</span>)</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">let</span> imageView <span class="operator">=</span> <span class="type">UIImageView</span>()</span><br><span class="line">       imageView.animationImages <span class="operator">=</span> background</span><br><span class="line">       imageView.animationDuration <span class="operator">=</span> <span class="number">5</span></span><br><span class="line">       imageView.animationRepeatCount <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">       imageView.startAnimating()</span><br><span class="line">       <span class="keyword">self</span>.view.addSubview(imageView)</span><br><span class="line">       imageView.snp.makeConstraints &#123;(bg) <span class="keyword">in</span></span><br><span class="line">           bg.top.bottom.left.right.equalTo(<span class="number">0</span>)</span><br><span class="line">           bg.center.equalToSuperview()</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></li><li><p>timer配置（打字机）、增加约束</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">consLabel.backgroundColor <span class="operator">=</span> <span class="type">UIColor</span>.clear</span><br><span class="line">        <span class="keyword">self</span>.view.addSubview(consLabel)</span><br><span class="line">        consLabel.textColor <span class="operator">=</span> <span class="type">UIColor</span>.white</span><br><span class="line">        consLabel.lineBreakMode <span class="operator">=</span> <span class="type">NSLineBreakMode</span>.byWordWrapping</span><br><span class="line">        consLabel.numberOfLines <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">        consLabel.snp.makeConstraints &#123;(consLabel) <span class="keyword">in</span></span><br><span class="line">            consLabel.width.equalTo(<span class="number">300</span>)</span><br><span class="line">            consLabel.center.equalToSuperview()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> i <span class="operator">==</span> <span class="number">100</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> cons <span class="operator">==</span> <span class="string">&quot;白羊座&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;金牛座&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;双子座&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;巨蟹座&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;狮子座&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;处女座&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;天秤座&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;天蝎座&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;射手座&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;摩羯座&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;水瓶座&quot;</span> <span class="operator">||</span> cons <span class="operator">==</span> <span class="string">&quot;双鱼座&quot;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> printStr <span class="operator">=</span> <span class="string">&quot;<span class="subst">\(info[<span class="string">&quot;datetime&quot;</span>]<span class="operator">!</span>.string<span class="operator">!</span>)</span>的<span class="subst">\(info[<span class="string">&quot;name&quot;</span>]<span class="operator">!</span>.string<span class="operator">!</span>)</span><span class="subst">\n</span>综合指数:<span class="subst">\(info[<span class="string">&quot;all&quot;</span>]<span class="operator">!</span>.string<span class="operator">!</span>)</span><span class="subst">\n</span>幸运色:<span class="subst">\(info[<span class="string">&quot;color&quot;</span>]<span class="operator">!</span>.string<span class="operator">!</span>)</span><span class="subst">\n</span>健康指数:<span class="subst">\(info[<span class="string">&quot;health&quot;</span>]<span class="operator">!</span>.string<span class="operator">!</span>)</span><span class="subst">\n</span>爱情指数:<span class="subst">\(info[<span class="string">&quot;love&quot;</span>]<span class="operator">!</span>.string<span class="operator">!</span>)</span><span class="subst">\n</span>财运指数:<span class="subst">\(info[<span class="string">&quot;money&quot;</span>]<span class="operator">!</span>.string<span class="operator">!</span>)</span><span class="subst">\n</span>幸运数字:<span class="subst">\(info[<span class="string">&quot;number&quot;</span>]<span class="operator">!</span>.int<span class="operator">!</span>)</span><span class="subst">\n</span>速配星座:<span class="subst">\(info[<span class="string">&quot;QFriend&quot;</span>]<span class="operator">!</span>.string<span class="operator">!</span>)</span><span class="subst">\n</span>工作指数:<span class="subst">\(info[<span class="string">&quot;work&quot;</span>]<span class="operator">!</span>.string<span class="operator">!</span>)</span><span class="subst">\n</span>今日概述:<span class="subst">\(info[<span class="string">&quot;summary&quot;</span>]<span class="operator">!</span>.string<span class="operator">!</span>)</span>&quot;</span></span><br><span class="line">            preTextLabel.text <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="type">TextField</span>.removeFromSuperview()</span><br><span class="line">            <span class="keyword">if</span> times <span class="operator">&lt;=</span> printStr.count &#123;</span><br><span class="line">                <span class="keyword">let</span> output <span class="operator">=</span> printStr.prefix(times)</span><br><span class="line">                <span class="keyword">let</span> paraph <span class="operator">=</span> <span class="type">NSMutableParagraphStyle</span>()</span><br><span class="line">                paraph.lineSpacing <span class="operator">=</span> <span class="number">10</span></span><br><span class="line">                <span class="keyword">let</span> attributes <span class="operator">=</span> [<span class="type">NSAttributedString</span>.<span class="type">Key</span>.font: <span class="type">UIFont</span>(name: <span class="string">&quot;Zpix&quot;</span>, size: <span class="number">22</span>),</span><br><span class="line">                                  <span class="type">NSAttributedString</span>.<span class="type">Key</span>.paragraphStyle: paraph]</span><br><span class="line">                consLabel.attributedText <span class="operator">=</span> <span class="type">NSAttributedString</span>(string: <span class="type">String</span>(output), attributes: attributes)</span><br><span class="line">                times<span class="operator">+=</span><span class="number">1</span></span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                timer2.invalidate()</span><br><span class="line">                <span class="keyword">let</span> <span class="type">Return</span> <span class="operator">=</span> <span class="type">UIButton</span>(type: <span class="type">UIButton</span>.<span class="type">ButtonType</span>.roundedRect)</span><br><span class="line">                <span class="keyword">let</span> returnImage <span class="operator">=</span> <span class="type">UIImage</span>(named: <span class="string">&quot;return&quot;</span>)</span><br><span class="line">                <span class="type">Return</span>.setBackgroundImage(returnImage, for: .normal)</span><br><span class="line">                <span class="type">Return</span>.addTarget(<span class="keyword">self</span>, action: #selector(<span class="keyword">self</span>.returnHome(<span class="keyword">_</span>:)), for: <span class="type">UIControl</span>.<span class="type">Event</span>.touchUpInside)</span><br><span class="line">                <span class="keyword">self</span>.view.addSubview(<span class="type">Return</span>)</span><br><span class="line">                <span class="type">Return</span>.snp.makeConstraints &#123;(button) <span class="keyword">in</span></span><br><span class="line">                    button.centerX.equalTo(consLabel).offset(<span class="number">150</span>)</span><br><span class="line">                    button.centerY.equalTo(consLabel).offset(<span class="number">320</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                preTextLabel.text <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line">                <span class="type">TextField</span>.removeFromSuperview()</span><br><span class="line">                <span class="keyword">let</span> str <span class="operator">=</span> <span class="string">&quot;没有在星座大全中找到<span class="subst">\(cons)</span><span class="subst">\n</span>检查一下吧&quot;</span></span><br><span class="line">                <span class="keyword">if</span> times <span class="operator">&lt;=</span> str.count &#123;</span><br><span class="line">                    <span class="keyword">let</span> output <span class="operator">=</span> str.prefix(times)</span><br><span class="line">                    <span class="keyword">let</span> paraph <span class="operator">=</span> <span class="type">NSMutableParagraphStyle</span>()</span><br><span class="line">                    paraph.lineSpacing <span class="operator">=</span> <span class="number">10</span></span><br><span class="line">                    <span class="keyword">let</span> attributes <span class="operator">=</span> [<span class="type">NSAttributedString</span>.<span class="type">Key</span>.font: <span class="type">UIFont</span>(name: <span class="string">&quot;Zpix&quot;</span>, size: <span class="number">22</span>),</span><br><span class="line">                                                     <span class="type">NSAttributedString</span>.<span class="type">Key</span>.paragraphStyle: paraph]</span><br><span class="line">                    consLabel.attributedText <span class="operator">=</span> <span class="type">NSAttributedString</span>(string: <span class="type">String</span>(output), attributes: attributes)</span><br><span class="line">                    times<span class="operator">+=</span><span class="number">1</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    timer2.invalidate()</span><br><span class="line">                    <span class="keyword">let</span> <span class="type">Return</span> <span class="operator">=</span> <span class="type">UIButton</span>(type: <span class="type">UIButton</span>.<span class="type">ButtonType</span>.roundedRect)</span><br><span class="line">                    <span class="keyword">let</span> returnImage <span class="operator">=</span> <span class="type">UIImage</span>(named: <span class="string">&quot;return&quot;</span>)</span><br><span class="line">                    <span class="type">Return</span>.setBackgroundImage(returnImage, for: .normal)</span><br><span class="line">                    <span class="type">Return</span>.addTarget(<span class="keyword">self</span>, action: #selector(<span class="keyword">self</span>.returnHome(<span class="keyword">_</span>:)), for: <span class="type">UIControl</span>.<span class="type">Event</span>.touchUpInside)</span><br><span class="line">                    <span class="keyword">self</span>.view.addSubview(<span class="type">Return</span>)</span><br><span class="line">                    <span class="type">Return</span>.snp.makeConstraints &#123;(button) <span class="keyword">in</span></span><br><span class="line">                        button.centerX.equalTo(consLabel).offset(<span class="number">110</span>)</span><br><span class="line">                        button.centerY.equalTo(consLabel).offset(<span class="number">40</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><a href="/download/FateViewController.swift">原文件</a></p></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;Fate页主要实现功能：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;用户输入星座&lt;/li&gt;
&lt;li&gt;返回当日运势&lt;/li&gt;
&lt;li&gt;打字机输出&lt;/li&gt;
&lt;li&gt;返回首页&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="iOS" scheme="https://sknyt.xyz/categories/iOS/"/>
    
    
    <category term="MyPlanet" scheme="https://sknyt.xyz/tags/MyPlanet/"/>
    
  </entry>
  
  <entry>
    <title>My Planet-WeatherViewController</title>
    <link href="https://sknyt.xyz/iOS/Weather/"/>
    <id>https://sknyt.xyz/iOS/Weather/</id>
    <published>2020-04-04T03:36:36.000Z</published>
    <updated>2021-02-17T03:59:13.735Z</updated>
    
    <content type="html"><![CDATA[<p>Music页主要实现功能：</p><ul><li>自动定位</li><li>获取当地天气</li><li>打字机显示</li><li>返回首页</li></ul><a id="more"></a><hr><p>API源：<a href="https://developer.amap.com/">高德API</a></p><hr><p>地名与编号对应文档：<a href="/download/WeatherNum.plist">点击下载</a></p><hr><h2 id="全局部分"><a href="#全局部分" class="headerlink" title="全局部分"></a>全局部分</h2><ol><li><p>引入：</p><ul><li>UIKit</li><li>CoreLocation</li><li><a href="https://github.com/SwiftyJSON/SwiftyJSON">SwiftyJSON（JSON解决方案）</a></li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> CoreLocation</span><br><span class="line"><span class="keyword">import</span> SwiftyJSON</span><br></pre></td></tr></table></figure><h2 id="UIViewController类"><a href="#UIViewController类" class="headerlink" title="UIViewController类"></a>UIViewController类</h2></li><li><p>变量、常量声明：</p><ul><li>UILabel</li><li>UITextField（用于输出文本）</li><li>API地址</li><li>重组字符串</li><li>准备文字</li><li>timer</li><li>现在区域</li><li>遍历次数</li><li>JSON包</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> preTextLabel <span class="operator">=</span> <span class="type">UILabel</span>()</span><br><span class="line"><span class="keyword">let</span> weatherInfo <span class="operator">=</span> <span class="type">UILabel</span>()</span><br><span class="line"><span class="keyword">let</span> textField <span class="operator">=</span> <span class="type">UITextField</span>()</span><br><span class="line"><span class="keyword">var</span> warning <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tudeToLocation <span class="operator">=</span> <span class="string">&quot;https://restapi.amap.com/v3/geocode/regeo?output=JSON&amp;radius=1000&amp;extensions=all&amp;key=14960ff6beb497b9b3976a298a7823d4&amp;location=%@&quot;</span></span><br><span class="line"><span class="keyword">let</span> weatherUrl <span class="operator">=</span> <span class="string">&quot;https://restapi.amap.com/v3/weather/weatherInfo?key=ac27e18866b8b0b3b5270054264a484d&amp;city=%@&quot;</span></span><br><span class="line"><span class="keyword">let</span> preText <span class="operator">=</span> <span class="string">&quot;正在给气象局打电话...&quot;</span></span><br><span class="line"><span class="keyword">var</span> timer:<span class="type">Timer</span>!</span><br><span class="line"><span class="keyword">var</span> timer2:<span class="type">Timer</span>!</span><br><span class="line"><span class="keyword">var</span> nowDistrict <span class="operator">=</span> <span class="string">&quot;nil&quot;</span></span><br><span class="line"><span class="keyword">var</span> times <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> info:<span class="type">Dictionary</span>&lt;<span class="type">String</span>,<span class="type">JSON</span>&gt; <span class="operator">=</span> [<span class="string">&quot;温度&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>),<span class="string">&quot;湿度&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>),<span class="string">&quot;天气&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>),<span class="string">&quot;风向&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>),<span class="string">&quot;风力&quot;</span>:<span class="type">JSON</span>(<span class="string">&quot;nil&quot;</span>)]</span><br><span class="line">   </span><br><span class="line"><span class="keyword">var</span> i <span class="operator">=</span> <span class="number">0</span></span><br></pre></td></tr></table></figure></li><li><p>timer配置</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">preTextLabel.backgroundColor <span class="operator">=</span> <span class="type">UIColor</span>.clear</span><br><span class="line">            <span class="keyword">self</span>.view.addSubview(preTextLabel)</span><br><span class="line">            preTextLabel.textColor <span class="operator">=</span> <span class="type">UIColor</span>.white</span><br><span class="line">            preTextLabel.font <span class="operator">=</span> <span class="type">UIFont</span>(name: <span class="string">&quot;Zpix&quot;</span>, size: <span class="number">20</span>)</span><br><span class="line">            preTextLabel.lineBreakMode <span class="operator">=</span> <span class="type">NSLineBreakMode</span>.byWordWrapping</span><br><span class="line">            preTextLabel.numberOfLines <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">            preTextLabel.snp.makeConstraints &#123;(preTextLabel) <span class="keyword">in</span></span><br><span class="line">                preTextLabel.width.equalTo(<span class="number">300</span>)</span><br><span class="line">                preTextLabel.centerX.equalToSuperview().offset(<span class="operator">-</span><span class="number">25</span>)</span><br><span class="line">                preTextLabel.centerY.equalToSuperview().offset(<span class="operator">-</span><span class="number">50</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> i <span class="operator">&lt;=</span> <span class="number">12</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> output <span class="operator">=</span> preText.prefix(i)</span><br><span class="line">            preTextLabel.text <span class="operator">=</span> <span class="type">String</span>(output)</span><br><span class="line">            i<span class="operator">+=</span><span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            timer.invalidate()</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></li><li><p>复写viewDidLoad</p><ul><li>配置timer</li><li>配置plist文件路径</li><li>配置JSON字典文件转为data</li><li>读取plist文件</li><li>拼接字符串</li><li>配置URL连接</li><li>开启URL会话</li><li>分析返回数据并按照“温度、湿度、风向、风力、天气”分类并放入字典</li><li>设置背景</li><li>约束</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">timer <span class="operator">=</span> <span class="type">Timer</span>.scheduledTimer(timeInterval: <span class="number">0.3</span>, target: <span class="keyword">self</span>, selector: #selector(<span class="type">WeatherViewController</span>.preTextPrint(<span class="keyword">_</span>:)), userInfo: <span class="literal">nil</span>, repeats: <span class="literal">true</span>)</span><br><span class="line">timer2 <span class="operator">=</span> <span class="type">Timer</span>.scheduledTimer(timeInterval: <span class="number">0.1</span>, target: <span class="keyword">self</span>, selector: #selector(<span class="type">WeatherViewController</span>.weatherinfo(<span class="keyword">_</span>:)), userInfo: <span class="literal">nil</span>, repeats: <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> plistPath <span class="operator">=</span> <span class="type">Bundle</span>.main.path(forResource: <span class="string">&quot;WeatherNum&quot;</span>, ofType: <span class="string">&quot;plist&quot;</span>)</span><br><span class="line"><span class="keyword">let</span> data <span class="operator">=</span> <span class="type">NSMutableDictionary</span>.<span class="keyword">init</span>(contentsOfFile: plistPath<span class="operator">!</span>)<span class="operator">!</span></span><br><span class="line"></span><br><span class="line"><span class="type">UserDefaults</span>().string(forKey: <span class="string">&quot;info&quot;</span>)</span><br><span class="line"><span class="keyword">let</span> <span class="type">RelongtitudePlusLatitude</span>  <span class="operator">=</span> longtitudePlusLatitude<span class="operator">?</span>.addingPercentEncoding(withAllowedCharacters: <span class="type">CharacterSet</span>.urlQueryAllowed) <span class="operator">??</span> <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">let</span> config1 <span class="operator">=</span> <span class="type">URLSessionConfiguration</span>.default</span><br><span class="line"><span class="keyword">let</span> url1 <span class="operator">=</span> <span class="type">URL</span>(string: <span class="type">String</span>(format: tudeToLocation, <span class="type">RelongtitudePlusLatitude</span>))</span><br><span class="line"><span class="keyword">let</span> request1 <span class="operator">=</span> <span class="type">URLRequest</span>(url: url1<span class="operator">!</span>)</span><br><span class="line"><span class="keyword">let</span> session1 <span class="operator">=</span> <span class="type">URLSession</span>(configuration: config1)</span><br><span class="line"><span class="keyword">let</span> task1 <span class="operator">=</span> session1.dataTask(with: request1) &#123; (data1, response, error) <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">let</span> json1 <span class="operator">=</span> <span class="keyword">try!</span> <span class="type">JSON</span>(data: data1<span class="operator">!</span>)</span><br><span class="line">    <span class="keyword">self</span>.nowDistrict <span class="operator">=</span> json1[<span class="string">&quot;regeocode&quot;</span>][<span class="string">&quot;addressComponent&quot;</span>][<span class="string">&quot;district&quot;</span>].stringValue</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">self</span>.nowDistrict <span class="operator">==</span> <span class="string">&quot;&quot;</span> <span class="operator">||</span> <span class="keyword">self</span>.nowDistrict <span class="operator">==</span> <span class="string">&quot;&quot;</span>&#123;</span><br><span class="line">        <span class="keyword">self</span>.warning <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">let</span> alertController <span class="operator">=</span> <span class="type">UIAlertController</span>(title: <span class="string">&quot;没有获取到您的经纬度<span class="subst">\n</span>即将返回星球主页…&quot;</span>, message: <span class="literal">nil</span>, preferredStyle: .alert)</span><br><span class="line">        <span class="keyword">self</span>.present(alertController, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">        <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: <span class="type">DispatchTime</span>.now() <span class="operator">+</span> <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.presentedViewController<span class="operator">?</span>.dismiss(animated: <span class="literal">false</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">            <span class="keyword">self</span>.dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">   </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> midNum <span class="operator">=</span> data[<span class="keyword">self</span>.nowDistrict]<span class="operator">!</span> <span class="keyword">as!</span> <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> districtNum <span class="operator">=</span> midNum</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> weatherUrl <span class="operator">=</span> <span class="string">&quot;https://restapi.amap.com/v3/weather/weatherInfo?key=ac27e18866b8b0b3b5270054264a484d&amp;city=<span class="subst">\(districtNum)</span>&quot;</span></span><br><span class="line">    <span class="keyword">let</span> config2 <span class="operator">=</span> <span class="type">URLSessionConfiguration</span>.default</span><br><span class="line">    <span class="keyword">let</span> url2 <span class="operator">=</span> <span class="type">URL</span>(string: <span class="type">String</span>(format: weatherUrl))</span><br><span class="line">    <span class="keyword">let</span> request2 <span class="operator">=</span> <span class="type">URLRequest</span>(url: url2<span class="operator">!</span>)</span><br><span class="line">    <span class="keyword">let</span> session2 <span class="operator">=</span> <span class="type">URLSession</span>(configuration: config2)</span><br><span class="line">    <span class="keyword">let</span> task2 <span class="operator">=</span> session2.dataTask(with: request2) &#123; (data2, response, error) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> json2 <span class="operator">=</span> <span class="keyword">try!</span> <span class="type">JSON</span>(data: data2<span class="operator">!</span>)</span><br><span class="line">        <span class="keyword">self</span>.info[<span class="string">&quot;温度&quot;</span>] <span class="operator">=</span> json2[<span class="string">&quot;lives&quot;</span>][<span class="number">0</span>][<span class="string">&quot;temperature&quot;</span>]</span><br><span class="line">        <span class="keyword">self</span>.info[<span class="string">&quot;湿度&quot;</span>] <span class="operator">=</span> json2[<span class="string">&quot;lives&quot;</span>][<span class="number">0</span>][<span class="string">&quot;humidity&quot;</span>]</span><br><span class="line">        <span class="keyword">self</span>.info[<span class="string">&quot;风向&quot;</span>] <span class="operator">=</span> json2[<span class="string">&quot;lives&quot;</span>][<span class="number">0</span>][<span class="string">&quot;winddirection&quot;</span>]</span><br><span class="line">        <span class="keyword">self</span>.info[<span class="string">&quot;风力&quot;</span>] <span class="operator">=</span> json2[<span class="string">&quot;lives&quot;</span>][<span class="number">0</span>][<span class="string">&quot;windpower&quot;</span>]</span><br><span class="line">        <span class="keyword">self</span>.info[<span class="string">&quot;天气&quot;</span>] <span class="operator">=</span> json2[<span class="string">&quot;lives&quot;</span>][<span class="number">0</span>][<span class="string">&quot;weather&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    task2.resume()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">task1.resume()</span><br><span class="line"><span class="keyword">var</span> background <span class="operator">=</span> [<span class="type">UIImage</span>]()</span><br><span class="line">              <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span> <span class="operator">...</span> <span class="number">4</span> &#123;</span><br><span class="line">                  background.append(<span class="type">UIImage</span>(named: <span class="string">&quot;bg<span class="subst">\(i)</span>&quot;</span>)<span class="operator">!</span>)</span><br><span class="line">              &#125;</span><br><span class="line"><span class="keyword">let</span> imageView <span class="operator">=</span> <span class="type">UIImageView</span>()</span><br><span class="line">imageView.animationImages <span class="operator">=</span> background</span><br><span class="line">imageView.animationDuration <span class="operator">=</span> <span class="number">5</span></span><br><span class="line">imageView.animationRepeatCount <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">imageView.startAnimating()</span><br><span class="line"><span class="keyword">self</span>.view.addSubview(imageView)</span><br><span class="line">    imageView.snp.makeConstraints &#123;(bg) <span class="keyword">in</span></span><br><span class="line">    bg.top.bottom.left.right.equalTo(<span class="number">0</span>)</span><br><span class="line">    bg.center.equalToSuperview()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>timer配置（打字机）</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> humidity <span class="operator">=</span> info[<span class="string">&quot;湿度&quot;</span>]<span class="operator">?</span>.string</span><br><span class="line">        <span class="keyword">let</span> temperature <span class="operator">=</span> info[<span class="string">&quot;温度&quot;</span>]<span class="operator">?</span>.string</span><br><span class="line">        <span class="keyword">let</span> winddirection <span class="operator">=</span> info[<span class="string">&quot;风向&quot;</span>]<span class="operator">?</span>.string</span><br><span class="line">        <span class="keyword">let</span> weather <span class="operator">=</span> info[<span class="string">&quot;天气&quot;</span>]<span class="operator">?</span>.string</span><br><span class="line">        <span class="keyword">let</span> windpower <span class="operator">=</span> info[<span class="string">&quot;风力&quot;</span>]<span class="operator">?</span>.string</span><br><span class="line">        <span class="keyword">let</span> weatherString <span class="operator">=</span> <span class="string">&quot;<span class="subst">\(nowDistrict)</span>现在的天气是:<span class="subst">\n</span>温度:<span class="subst">\(temperature<span class="operator">!</span>)</span>℃！<span class="subst">\n</span>湿度:<span class="subst">\(humidity<span class="operator">!</span>)</span>%！<span class="subst">\n</span>天气状况:<span class="subst">\(weather<span class="operator">!</span>)</span>！<span class="subst">\n</span>风力:<span class="subst">\(windpower<span class="operator">!</span>)</span>！<span class="subst">\n</span>风向:<span class="subst">\(winddirection<span class="operator">!</span>)</span>！<span class="subst">\n</span>报告完毕！&quot;</span></span><br><span class="line">        weatherInfo.backgroundColor <span class="operator">=</span> <span class="type">UIColor</span>.clear</span><br><span class="line">        <span class="keyword">self</span>.view.addSubview(weatherInfo)</span><br><span class="line">        weatherInfo.textColor <span class="operator">=</span> <span class="type">UIColor</span>.white</span><br><span class="line">        weatherInfo.lineBreakMode <span class="operator">=</span> <span class="type">NSLineBreakMode</span>.byWordWrapping</span><br><span class="line">        weatherInfo.numberOfLines <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">        weatherInfo.snp.makeConstraints &#123;(weatherInfo) <span class="keyword">in</span></span><br><span class="line">            weatherInfo.center.equalToSuperview()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> warning <span class="operator">==</span> <span class="number">1</span>&#123;</span><br><span class="line">            weatherInfo.removeFromSuperview()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> i<span class="operator">==</span><span class="number">13</span> &#123;</span><br><span class="line">            preTextLabel.text <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">if</span> times <span class="operator">&lt;=</span> weatherString.count&#123;</span><br><span class="line">                <span class="keyword">let</span> output <span class="operator">=</span> weatherString.prefix(times)</span><br><span class="line">                <span class="keyword">let</span> paraph <span class="operator">=</span> <span class="type">NSMutableParagraphStyle</span>()</span><br><span class="line">                paraph.lineSpacing <span class="operator">=</span> <span class="number">10</span></span><br><span class="line">                <span class="keyword">let</span> attributes <span class="operator">=</span> [<span class="type">NSAttributedString</span>.<span class="type">Key</span>.font: <span class="type">UIFont</span>(name: <span class="string">&quot;Zpix&quot;</span>, size: <span class="number">22</span>),<span class="type">NSAttributedString</span>.<span class="type">Key</span>.paragraphStyle: paraph]</span><br><span class="line">                weatherInfo.attributedText <span class="operator">=</span> <span class="type">NSAttributedString</span>(string: <span class="type">String</span>(output), attributes: attributes <span class="keyword">as</span> [<span class="type">NSAttributedString</span>.Key : <span class="keyword">Any</span>])</span><br><span class="line">                times<span class="operator">+=</span><span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                timer2.invalidate()</span><br><span class="line">                <span class="keyword">let</span> <span class="type">Return</span> <span class="operator">=</span> <span class="type">UIButton</span>(type: <span class="type">UIButton</span>.<span class="type">ButtonType</span>.roundedRect)</span><br><span class="line">                <span class="keyword">let</span> returnImage <span class="operator">=</span> <span class="type">UIImage</span>(named: <span class="string">&quot;return&quot;</span>)</span><br><span class="line">                <span class="type">Return</span>.setBackgroundImage(returnImage, for: .normal)</span><br><span class="line">                <span class="type">Return</span>.addTarget(<span class="keyword">self</span>, action: #selector(<span class="keyword">self</span>.returnHome(<span class="keyword">_</span>:)), for: <span class="type">UIControl</span>.<span class="type">Event</span>.touchUpInside)</span><br><span class="line">                <span class="keyword">self</span>.view.addSubview(<span class="type">Return</span>)</span><br><span class="line">                <span class="type">Return</span>.snp.makeConstraints &#123;(button) <span class="keyword">in</span></span><br><span class="line">                    button.centerX.equalTo(weatherInfo).offset(<span class="number">100</span>)</span><br><span class="line">                    button.centerY.equalTo(weatherInfo).offset(<span class="number">120</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></li><li><p>返回首页</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">returnHome</span>(<span class="keyword">_</span> <span class="params">button</span>: <span class="type">UIButton</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="/download/WeatherViewController.swift">原文件</a></p></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;Music页主要实现功能：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;自动定位&lt;/li&gt;
&lt;li&gt;获取当地天气&lt;/li&gt;
&lt;li&gt;打字机显示&lt;/li&gt;
&lt;li&gt;返回首页&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="iOS" scheme="https://sknyt.xyz/categories/iOS/"/>
    
    
    <category term="MyPlanet" scheme="https://sknyt.xyz/tags/MyPlanet/"/>
    
  </entry>
  
  <entry>
    <title>My Planet-MusicViewController</title>
    <link href="https://sknyt.xyz/iOS/Music/"/>
    <id>https://sknyt.xyz/iOS/Music/</id>
    <published>2020-04-04T03:10:53.000Z</published>
    <updated>2021-02-17T03:59:27.577Z</updated>
    
    <content type="html"><![CDATA[<p>Music页主要实现功能：</p><ul><li>在线播放流媒体</li><li>简单交互</li><li>RemoteController交互</li><li>返回首页</li></ul><a id="more"></a><hr><h2 id="全局部分"><a href="#全局部分" class="headerlink" title="全局部分"></a>全局部分</h2><ol><li><p>引入：</p><ul><li>UIKit</li><li>SnapKit</li><li>AVFoundation（音频处理）</li><li>MediaPlayer（音频处理）</li><li><a href="https://github.com/tumtumtum/StreamingKit">开源StreamingKit流媒体处理包（swift与oc混编）</a><a href="/download/StreamingKit.zip">文件下载</a></li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> SnapKit</span><br><span class="line"><span class="keyword">import</span> AVFoundation</span><br><span class="line"><span class="keyword">import</span> MediaPlayer</span><br></pre></td></tr></table></figure></li><li><p>枚举播放器状态</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">state</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> playing</span><br><span class="line">    <span class="keyword">case</span> notPlaying</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="UIViewController类"><a href="#UIViewController类" class="headerlink" title="UIViewController类"></a>UIViewController类</h2></li><li><p>变量、常量声明：</p><ul><li>随机数（用于确定随机播放在线音乐）</li><li>timer</li><li>STKAudioPlayer播放器</li><li>已播放时长</li><li>总时长</li><li>缓存状态</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> randomNumber <span class="operator">=</span> <span class="type">Int</span>(arc4random()<span class="operator">%</span><span class="number">5</span>)<span class="operator">+</span><span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> timer:<span class="type">Timer</span>!</span><br><span class="line"><span class="keyword">var</span> bgm:<span class="type">Timer</span>!</span><br><span class="line"><span class="keyword">let</span> audioPlayer <span class="operator">=</span> <span class="type">STKAudioPlayer</span>()</span><br><span class="line"><span class="keyword">var</span> duration <span class="operator">=</span> <span class="number">0.0</span></span><br><span class="line"><span class="keyword">var</span> progess <span class="operator">=</span> <span class="number">0.0</span></span><br><span class="line"><span class="keyword">var</span> bufferingStatus <span class="operator">=</span> <span class="number">2</span></span><br></pre></td></tr></table></figure></li><li><p>audioPlayer代理</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">audioPlayer</span>(<span class="keyword">_</span> <span class="params">audioPlayer</span>: <span class="type">STKAudioPlayer</span>, <span class="params">didStartPlayingQueueItemId</span> <span class="params">queueItemId</span>: <span class="type">NSObject</span>)</span> &#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">audioPlayer</span>(<span class="keyword">_</span> <span class="params">audioPlayer</span>: <span class="type">STKAudioPlayer</span>, <span class="params">didFinishBufferingSourceWithQueueItemId</span> <span class="params">queueItemId</span>: <span class="type">NSObject</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="type">NumC</span>:<span class="type">Int</span></span><br><span class="line">    <span class="type">NumC</span> <span class="operator">=</span> randomNumber</span><br><span class="line">    randomNumber <span class="operator">=</span> <span class="type">Int</span>(arc4random()<span class="operator">%</span><span class="number">5</span>)<span class="operator">+</span><span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">true</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="type">NumC</span> <span class="operator">==</span> randomNumber &#123;</span><br><span class="line">             randomNumber <span class="operator">=</span> <span class="type">Int</span>(arc4random()<span class="operator">%</span><span class="number">5</span>)<span class="operator">+</span><span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    bufferingStatus <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">audioPlayer</span>(<span class="keyword">_</span> <span class="params">audioPlayer</span>: <span class="type">STKAudioPlayer</span>, <span class="params">stateChanged</span> <span class="params">state</span>: <span class="type">STKAudioPlayerState</span>, <span class="params">previousState</span>: <span class="type">STKAudioPlayerState</span>)</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">audioPlayer</span>(<span class="keyword">_</span> <span class="params">audioPlayer</span>: <span class="type">STKAudioPlayer</span>, <span class="params">didFinishPlayingQueueItemId</span> <span class="params">queueItemId</span>: <span class="type">NSObject</span>, <span class="params">with</span> <span class="params">stopReason</span>: <span class="type">STKAudioPlayerStopReason</span>, <span class="params">andProgress</span> <span class="params">progress</span>: <span class="type">Double</span>, <span class="params">andDuration</span> <span class="params">duration</span>: <span class="type">Double</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> bufferingStatus <span class="operator">!=</span> <span class="number">2</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="type">NumC</span>:<span class="type">Int</span></span><br><span class="line">        <span class="type">NumC</span> <span class="operator">=</span> randomNumber</span><br><span class="line">        randomNumber <span class="operator">=</span> <span class="type">Int</span>(arc4random()<span class="operator">%</span><span class="number">5</span>)<span class="operator">+</span><span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">true</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="type">NumC</span> <span class="operator">==</span> randomNumber &#123;</span><br><span class="line">                 randomNumber <span class="operator">=</span> <span class="type">Int</span>(arc4random()<span class="operator">%</span><span class="number">5</span>)<span class="operator">+</span><span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        bufferingStatus <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">    audioPlayer.stop()</span><br><span class="line">    bgm <span class="operator">=</span> <span class="type">Timer</span>.scheduledTimer(timeInterval: <span class="number">0.3</span>, target: <span class="keyword">self</span>, selector: #selector(<span class="keyword">self</span>.bgm(<span class="keyword">_</span>:)), userInfo: <span class="literal">nil</span>, repeats: <span class="literal">true</span>)</span><br><span class="line">    audioPlayer.unmute()</span><br><span class="line">    audioPlayer.play(<span class="string">&quot;http://47.115.141.93/songs/<span class="subst">\(randomNumber)</span>.mp3&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">audioPlayer</span>(<span class="keyword">_</span> <span class="params">audioPlayer</span>: <span class="type">STKAudioPlayer</span>, <span class="params">unexpectedError</span> <span class="params">errorCode</span>: <span class="type">STKAudioPlayerErrorCode</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(errorCode)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>增加timer事件</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">tick</span>(<span class="keyword">_</span> <span class="params">timer</span>:<span class="type">Timer</span>)</span> &#123;</span><br><span class="line">    duration <span class="operator">=</span> audioPlayer.duration</span><br><span class="line">    progess <span class="operator">=</span> audioPlayer.progress</span><br><span class="line">    <span class="keyword">if</span> audioPlayer.state <span class="operator">!=</span> <span class="type">STKAudioPlayerState</span>.buffering &#123;</span><br><span class="line">        <span class="keyword">self</span>.bufferingStatus <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">bgm</span>(<span class="keyword">_</span> <span class="params">timer</span>:<span class="type">Timer</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> bufferingStatus <span class="operator">==</span> <span class="number">0</span> &#123;</span><br><span class="line">        setLockScreenDisplay()</span><br><span class="line">        bgm.invalidate()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>复写viewDidLoad：</p><ul><li>配置timer</li><li>配置audioPlayer</li><li>生效闭包</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">timer <span class="operator">=</span> <span class="type">Timer</span>.scheduledTimer(timeInterval: <span class="number">0.35</span>, target: <span class="keyword">self</span>, selector: #selector(<span class="keyword">self</span>.tick(<span class="keyword">_</span>:)), userInfo: <span class="literal">nil</span>, repeats: <span class="literal">true</span>)</span><br><span class="line">bgm <span class="operator">=</span> <span class="type">Timer</span>.scheduledTimer(timeInterval: <span class="number">0.3</span>, target: <span class="keyword">self</span>, selector: #selector(<span class="keyword">self</span>.bgm(<span class="keyword">_</span>:)), userInfo: <span class="literal">nil</span>, repeats: <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">audioPlayer.play(<span class="string">&quot;http://47.115.141.93/songs/<span class="subst">\(randomNumber)</span>.mp3&quot;</span>)</span><br><span class="line">audioPlayer.delegate <span class="operator">=</span> <span class="keyword">self</span></span><br><span class="line"></span><br><span class="line">background()</span><br><span class="line">backgroundMusic()</span><br><span class="line">creatRemoteCommandCenter()</span><br></pre></td></tr></table></figure></li><li><p>复写viewWillAppear</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">becomeFirstResponder()</span><br><span class="line">     <span class="type">UIApplication</span>.shared.beginReceivingRemoteControlEvents()</span><br></pre></td></tr></table></figure></li><li><p>复写viewWillDisappear</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">resignFirstResponder()</span><br><span class="line">        <span class="type">UIApplication</span>.shared.endReceivingRemoteControlEvents()</span><br></pre></td></tr></table></figure></li><li><p>RemoteCenter配置</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">creatRemoteCommandCenter</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> commandCenter <span class="operator">=</span> <span class="type">MPRemoteCommandCenter</span>.shared()</span><br><span class="line">        </span><br><span class="line">        commandCenter.playCommand.addTarget &#123; [] event <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.resumeAndPauseWhtherPause(<span class="literal">false</span>)</span><br><span class="line">            <span class="keyword">return</span> .success</span><br><span class="line">        &#125;</span><br><span class="line">        commandCenter.pauseCommand.addTarget &#123; [] event <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.resumeAndPauseWhtherPause(<span class="literal">true</span>)</span><br><span class="line">            <span class="keyword">return</span> .success</span><br><span class="line">        &#125;</span><br><span class="line">        commandCenter.nextTrackCommand.addTarget &#123; [] event <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.next()</span><br><span class="line">            <span class="keyword">return</span> .success</span><br><span class="line">        &#125;</span><br><span class="line">        commandCenter.previousTrackCommand.addTarget &#123; [] event <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.next()</span><br><span class="line">            <span class="keyword">return</span> .success</span><br><span class="line">        &#125;</span><br><span class="line">        commandCenter.changePlaybackPositionCommand.addTarget&#123; [] event <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">let</span> playbackPositionEvent <span class="operator">=</span> event <span class="keyword">as?</span> <span class="type">MPChangePlaybackPositionCommandEvent</span></span><br><span class="line">            <span class="keyword">self</span>.audioPlayer.seek(toTime: playbackPositionEvent<span class="operator">!</span>.positionTime)</span><br><span class="line">            <span class="keyword">return</span> .success</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>配置播放下一首歌闭包</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">next</span>()</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> info <span class="operator">=</span> <span class="type">MPNowPlayingInfoCenter</span>.default().nowPlayingInfo</span><br><span class="line">    audioPlayer.mute()</span><br><span class="line">    audioPlayer.pause()</span><br><span class="line">    <span class="keyword">var</span> <span class="type">NumC</span>:<span class="type">Int</span></span><br><span class="line">    <span class="type">NumC</span> <span class="operator">=</span> randomNumber</span><br><span class="line">    randomNumber <span class="operator">=</span> <span class="type">Int</span>(arc4random()<span class="operator">%</span><span class="number">5</span>)<span class="operator">+</span><span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">true</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="type">NumC</span> <span class="operator">==</span> randomNumber &#123;</span><br><span class="line">             randomNumber <span class="operator">=</span> <span class="type">Int</span>(arc4random()<span class="operator">%</span><span class="number">5</span>)<span class="operator">+</span><span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    bufferingStatus <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    audioPlayer.seek(toTime: duration<span class="operator">-</span><span class="number">0.001</span>)</span><br><span class="line">    info<span class="operator">!</span>[<span class="type">MPNowPlayingInfoPropertyElapsedPlaybackTime</span>] <span class="operator">=</span> audioPlayer.progress</span><br><span class="line">    audioPlayer.resume()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">resumeAndPauseWhtherPause</span>(<span class="keyword">_</span> <span class="params">status</span>: <span class="type">Bool</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> info <span class="operator">=</span> <span class="type">MPNowPlayingInfoCenter</span>.default().nowPlayingInfo</span><br><span class="line">    <span class="keyword">if</span> status &#123;</span><br><span class="line">        audioPlayer.pause()</span><br><span class="line">        info<span class="operator">!</span>[<span class="type">MPNowPlayingInfoPropertyPlaybackRate</span>] <span class="operator">=</span> <span class="number">0.00001</span></span><br><span class="line">        info<span class="operator">!</span>[<span class="type">MPNowPlayingInfoPropertyElapsedPlaybackTime</span>] <span class="operator">=</span> audioPlayer.progress</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        audioPlayer.resume()</span><br><span class="line">        info<span class="operator">!</span>[<span class="type">MPNowPlayingInfoPropertyPlaybackRate</span>] <span class="operator">=</span> <span class="number">1.0</span></span><br><span class="line">        info<span class="operator">!</span>[<span class="type">MPNowPlayingInfoPropertyElapsedPlaybackTime</span>] <span class="operator">=</span> audioPlayer.progress</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">MPNowPlayingInfoCenter</span>.default().nowPlayingInfo <span class="operator">=</span> info</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>设置锁屏RemoteController</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">setLockScreenDisplay</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> info <span class="operator">=</span> <span class="type">Dictionary</span>&lt;<span class="type">String</span>, <span class="keyword">Any</span>&gt;()</span><br><span class="line">        info[<span class="type">MPMediaItemPropertyTitle</span>] <span class="operator">=</span> randomNumber</span><br><span class="line">        info[<span class="type">MPMediaItemPropertyPlaybackDuration</span>] <span class="operator">=</span> <span class="type">TimeInterval</span>(duration)</span><br><span class="line">        info[<span class="type">MPNowPlayingInfoPropertyPlaybackRate</span>] <span class="operator">=</span> <span class="number">1.0</span></span><br><span class="line">        <span class="type">MPNowPlayingInfoCenter</span>.default().nowPlayingInfo <span class="operator">=</span> info</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>设置背景音乐闭包</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">backgroundMusic</span>()</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> session <span class="operator">=</span> <span class="type">AVAudioSession</span>.sharedInstance()</span><br><span class="line">        <span class="keyword">try?</span> session.setCategory(<span class="type">AVAudioSession</span>.<span class="type">Category</span>.playback)</span><br><span class="line">        <span class="built_in">print</span>(<span class="type">AVAudioSession</span>.<span class="type">Category</span>.playback)</span><br><span class="line">        <span class="keyword">try?</span> session.setActive(<span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><a href="/download/MusicViewController.swift">原文件</a></p></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;Music页主要实现功能：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在线播放流媒体&lt;/li&gt;
&lt;li&gt;简单交互&lt;/li&gt;
&lt;li&gt;RemoteController交互&lt;/li&gt;
&lt;li&gt;返回首页&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="iOS" scheme="https://sknyt.xyz/categories/iOS/"/>
    
    
    <category term="MyPlanet" scheme="https://sknyt.xyz/tags/MyPlanet/"/>
    
  </entry>
  
  <entry>
    <title>My Planet-MailViewController</title>
    <link href="https://sknyt.xyz/iOS/Mail/"/>
    <id>https://sknyt.xyz/iOS/Mail/</id>
    <published>2020-04-04T02:54:56.000Z</published>
    <updated>2021-02-17T03:59:33.336Z</updated>
    
    <content type="html"><![CDATA[<p>Mail页主要实现功能：</p><ul><li>单字逐秒显示</li><li>简单交互</li><li>返回首页</li></ul><a id="more"></a><hr><h2 id="全局部分"><a href="#全局部分" class="headerlink" title="全局部分"></a>全局部分</h2><ol><li><p>引入：</p><ul><li>UIKit</li><li>SnapKit</li><li>MessageUI</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> SnapKit</span><br><span class="line"><span class="keyword">import</span> MessageUI</span><br></pre></td></tr></table></figure><h2 id="UIViewController类"><a href="#UIViewController类" class="headerlink" title="UIViewController类"></a>UIViewController类</h2></li><li><p>变量、常量声明：</p><ul><li>显示的字符串</li><li>UILabel</li><li>遍历次数</li><li>UIButton</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str <span class="operator">=</span> <span class="string">&quot;2020年7月29日 星期三 <span class="subst">\n</span>...<span class="subst">\n</span>这将会是My Planet的最后一个版本<span class="subst">\n</span>终究是烂尾了<span class="subst">\n</span>Anyway...<span class="subst">\n</span>晚安...&quot;</span></span><br><span class="line">    <span class="keyword">let</span> text <span class="operator">=</span> <span class="type">UILabel</span>()</span><br><span class="line">    <span class="keyword">var</span> i <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">let</span> returnHomeBtn <span class="operator">=</span> <span class="type">UIButton</span>(type: <span class="type">UIButton</span>.<span class="type">ButtonType</span>.roundedRect)</span><br></pre></td></tr></table></figure></li><li><p>复写viewDidLoad闭包：</p><ul><li>timer配置</li><li>UIButton配置</li><li>背景图片遍历</li><li>UILabel配置、添加约束</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> timer:<span class="type">Timer</span>!</span><br><span class="line">timer <span class="operator">=</span> <span class="type">Timer</span>.scheduledTimer(timeInterval: <span class="number">0.1</span>, target: <span class="keyword">self</span>, selector: #selector(<span class="type">MailViewController</span>.wordPrint(<span class="keyword">_</span>:)), userInfo: <span class="literal">nil</span>, repeats: <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">returnHomeBtn.backgroundColor <span class="operator">=</span> <span class="type">UIColor</span>.clear</span><br><span class="line">returnHomeBtn.setTitle(<span class="string">&quot;返回主页&quot;</span>, for: .normal)</span><br><span class="line">returnHomeBtn.setTitleColor(<span class="type">UIColor</span>.white, for: <span class="type">UIControl</span>.<span class="type">State</span>())</span><br><span class="line">returnHomeBtn.titleLabel<span class="operator">?</span>.font <span class="operator">=</span> <span class="type">UIFont</span>(name: <span class="string">&quot;Zpix&quot;</span>, size: <span class="number">30</span>)</span><br><span class="line">returnHomeBtn.addTarget(<span class="keyword">self</span>, action: #selector(<span class="keyword">self</span>.returnHome(<span class="keyword">_</span>:)), for: <span class="type">UIControl</span>.<span class="type">Event</span>.touchUpInside)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> background <span class="operator">=</span> [<span class="type">UIImage</span>]()</span><br><span class="line">              <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span> <span class="operator">...</span> <span class="number">4</span> &#123;</span><br><span class="line">                  background.append(<span class="type">UIImage</span>(named: <span class="string">&quot;bg<span class="subst">\(i)</span>&quot;</span>)<span class="operator">!</span>)</span><br><span class="line">              &#125;</span><br><span class="line"><span class="keyword">let</span> imageView <span class="operator">=</span> <span class="type">UIImageView</span>()</span><br><span class="line">imageView.animationImages <span class="operator">=</span> background</span><br><span class="line">imageView.animationDuration <span class="operator">=</span> <span class="number">5</span></span><br><span class="line">imageView.animationRepeatCount <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">imageView.startAnimating()</span><br><span class="line"><span class="keyword">self</span>.view.addSubview(imageView)</span><br><span class="line">    imageView.snp.makeConstraints &#123;(bg) <span class="keyword">in</span></span><br><span class="line">    bg.top.bottom.left.right.equalTo(<span class="number">0</span>)</span><br><span class="line">    bg.center.equalToSuperview()</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line">text.backgroundColor <span class="operator">=</span> <span class="type">UIColor</span>.clear</span><br><span class="line"><span class="keyword">self</span>.view.addSubview(text)</span><br><span class="line">text.textColor <span class="operator">=</span> <span class="type">UIColor</span>.white</span><br><span class="line">text.lineBreakMode <span class="operator">=</span> <span class="type">NSLineBreakMode</span>.byWordWrapping</span><br><span class="line">text.numberOfLines <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">text.snp.makeConstraints &#123;(text) <span class="keyword">in</span></span><br><span class="line">    text.width.equalTo(<span class="number">300</span>)</span><br><span class="line">    text.center.equalToSuperview()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>timer配置</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> i <span class="operator">&lt;=</span> str.count&#123;</span><br><span class="line"><span class="keyword">let</span> output <span class="operator">=</span> str.prefix(i)</span><br><span class="line">    <span class="keyword">let</span> paraph <span class="operator">=</span> <span class="type">NSMutableParagraphStyle</span>()</span><br><span class="line">    paraph.lineSpacing <span class="operator">=</span> <span class="number">15</span></span><br><span class="line">    <span class="keyword">let</span> attributes <span class="operator">=</span> [<span class="type">NSAttributedString</span>.<span class="type">Key</span>.font: <span class="type">UIFont</span>(name: <span class="string">&quot;Zpix&quot;</span>, size: <span class="number">22</span>),</span><br><span class="line">                      <span class="type">NSAttributedString</span>.<span class="type">Key</span>.paragraphStyle: paraph]</span><br><span class="line">    text.attributedText <span class="operator">=</span> <span class="type">NSAttributedString</span>(string: <span class="type">String</span>(output), attributes: attributes)</span><br><span class="line">i<span class="operator">+=</span><span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    timer.invalidate()</span><br><span class="line">    <span class="keyword">self</span>.view.addSubview(returnHomeBtn)</span><br><span class="line">    returnHomeBtn.snp.makeConstraints &#123;(btn) <span class="keyword">in</span></span><br><span class="line">        btn.centerX.equalToSuperview()</span><br><span class="line">        btn.centerY.equalTo(text).offset(<span class="number">150</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>返回主界面按钮</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">returnHome</span>(<span class="keyword">_</span> <span class="params">btn</span>: <span class="type">UIButton</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.dismiss(animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="/download/MailViewController.swift">原文件</a></p></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;Mail页主要实现功能：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;单字逐秒显示&lt;/li&gt;
&lt;li&gt;简单交互&lt;/li&gt;
&lt;li&gt;返回首页&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="iOS" scheme="https://sknyt.xyz/categories/iOS/"/>
    
    
    <category term="MyPlanet" scheme="https://sknyt.xyz/tags/MyPlanet/"/>
    
  </entry>
  
</feed>
